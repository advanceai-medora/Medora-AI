2025-07-19 21:05:53,841 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-19 21:05:53,841 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-19 21:05:53,945 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-19 21:05:54,013 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-19 21:05:54,014 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-19 21:05:54,025 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-19 21:05:54,045 [INFO] MongoDB indexes created successfully
2025-07-19 21:05:54,045 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-19 21:06:05,891 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:06:05,891 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:06:05,891 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:06:05,892 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:06:06,021 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:06:06,022 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:06,023 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:06,023 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:06:06,025 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:06:06,026 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:06:06,026 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:06:06,027 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:06:06,027 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:06:06,040 [INFO] Deleted patient 687c0767771a22ce4789f9f0 and associated data in tenant ceo@advanceai.ai
2025-07-19 21:06:10,914 [INFO] Handling POST request for /api/visit/start
2025-07-19 21:06:10,915 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-19 21:06:10,920 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-19 21:06:10,922 [INFO] Patient cx. cvvv not found, creating new patient
2025-07-19 21:06:10,925 [INFO] Created new patient with ID: 687c08c23ee105650cd1cf5b
2025-07-19 21:06:10,929 [INFO] Visit started: 3227b938-b4e6-4bea-81d6-11b58d6f8863 for patient 687c08c23ee105650cd1cf5b by ceo@advanceai.ai
2025-07-19 21:06:12,176 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:06:12,176 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:06:12,176 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:06:12,176 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:06:12,176 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:06:12,177 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:12,177 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:12,178 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:06:12,179 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:06:12,179 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:06:12,179 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:06:12,180 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:06:12,181 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:06:12,182 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-19 21:06:12,185 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-19 21:06:12,527 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:06:12,527 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:06:12,527 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:06:12,527 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:06:12,527 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:06:12,529 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:12,529 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:12,529 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:06:12,529 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:06:12,529 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:06:12,530 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:06:12,530 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:06:12,530 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:06:12,530 [INFO] Fetching history for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:06:12,532 [INFO] Retrieved 0 transcripts for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:06:21,722 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-19 21:06:21,722 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-19 21:06:21,728 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-19 21:06:21,733 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 19), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 19, 21, 6, 21, 733418)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 19), of type: <class 'datetime.date'>
2025-07-19 21:06:21,734 [INFO] üìä Usage updated for ceo@advanceai.ai: 36/1000 (3.6%)
2025-07-19 21:06:22,764 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Dog Allergy', 'Drug Allergy', 'Topical Steroid Withdrawal', 'Herpes Simplex']
2025-07-19 21:06:28,528 [INFO] ‚úÖ FORMATTING: Generated assessment with 5 sections
2025-07-19 21:06:28,528 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019, suggesting environmental triggers
- Previous treatments with Dupixe...
2025-07-19 21:06:35,214 [INFO] Generated allergy treatment plan
2025-07-19 21:06:41,829 [INFO] üîß FORCE CREATING structured recommendations
2025-07-19 21:06:41,829 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-19 21:06:41,829 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:06:41,830 [INFO] üîç CHECKING HPI: Patient reports severe atopic dermatitis exacerbated since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working, leading to new patches of dermatitis. After discontinuing Rinvoq, patient experienced worsening symptoms, suspecting withdrawal effects. Dermatologist prescribed two rounds of antibiotics and prednisone, along with topical steroids, but symptoms persisted. Patient also started valacyclovir and fluconazole recently due to suspected yeast infection from antibiotics, without relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin. Symptoms are head-to-toe, sparing the face, with the bottoms of the feet resembling the palms of the hands, covered in scales. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-19 21:06:41,831 [INFO] ‚úÖ CLEAN: No problematic patterns found
2025-07-19 21:06:41,832 [INFO] üîÑ Generating structured recommendations...
2025-07-19 21:06:41,833 [INFO] üîß FORCE CREATING structured recommendations
2025-07-19 21:06:41,833 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-19 21:06:41,834 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:06:41,834 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-19 21:06:41,834 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Complete current course of prednisone as prescribed'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine'], 'FOLLOW-UP SCHEDULE': ['Return for follow-up appointment in 2 weeks', 'See primary care physician on Tuesday to discuss blood pressure medication change']}
2025-07-19 21:06:41,835 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-19 21:06:41,835 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:06:41,835 [INFO] ‚úÖ Added 5 structured recommendation categories
2025-07-19 21:06:41,835 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:06:41,881 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-19 21:06:41,899 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687c08e13ee105650cd1cf5d
2025-07-19 21:06:42,226 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:06:42,226 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:06:42,226 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:06:42,226 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:06:42,226 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:06:42,227 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:42,228 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:06:42,228 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:06:42,228 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:06:42,228 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:06:42,228 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:06:42,228 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:06:42,228 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:06:42,229 [INFO] Fetching history for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:06:42,231 [INFO] Retrieved 1 transcripts for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:06:42,525 [INFO] Handling GET request for /get-insights
2025-07-19 21:06:42,532 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019']
2025-07-19 21:06:42,534 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-19 21:06:42,555 [INFO] Found 0 insights for patient 687c08c23ee105650cd1cf5b using GSI
2025-07-19 21:06:44,278 [WARNING] Rate limited by Semantic Scholar for '1. Atopic Dermatitis:', skipping
2025-07-19 21:06:50,238 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-19 21:06:52,239 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019
2025-07-19 21:06:53,239 [INFO] Simplified long condition for Semantic Scholar: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:06:54,777 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:06:57,779 [INFO] Simplified long condition to: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:06:58,792 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:07:00,792 [INFO] Returning 1 insights for patient 687c08c23ee105650cd1cf5b
2025-07-19 21:09:18,878 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:18,879 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:09:18,879 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:09:18,879 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:09:18,880 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:09:18,881 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:09:18,881 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:09:18,882 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-19 21:09:18,884 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:21,984 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:09:21,985 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:09:21,985 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:09:21,987 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:09:21,987 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:09:21,988 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:09:21,988 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-19 21:09:21,989 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-19 21:09:24,570 [INFO] Handling POST request for /api/visit/start
2025-07-19 21:09:24,570 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-19 21:09:24,576 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-19 21:09:24,577 [INFO] Patient dcccff not found, creating new patient
2025-07-19 21:09:24,581 [INFO] Created new patient with ID: 687c09843ee105650cd1cf5e
2025-07-19 21:09:24,584 [INFO] Visit started: ae3a746b-7689-4347-85ba-2bc3cadda75f for patient 687c09843ee105650cd1cf5e by ceo@advanceai.ai
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:26,424 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:09:26,424 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:09:26,425 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:09:26,426 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:09:26,427 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:09:26,427 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:09:26,427 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-19 21:09:26,430 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-19 21:09:26,724 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:09:26,724 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:09:26,725 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:09:26,725 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:09:26,725 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:09:26,725 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:09:26,725 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:09:26,726 [INFO] Fetching history for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:09:26,728 [INFO] Retrieved 0 transcripts for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:09:35,498 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-19 21:09:35,499 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-19 21:09:35,505 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-19 21:09:35,509 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 19), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 19, 21, 9, 35, 509612)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 19), of type: <class 'datetime.date'>
2025-07-19 21:09:35,510 [INFO] üìä Usage updated for ceo@advanceai.ai: 37/1000 (3.7%)
2025-07-19 21:09:36,444 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Dog Allergy', 'Drug Allergy', 'Topical Steroid Withdrawal', 'Herpes Simplex', 'Yeast Infection']
2025-07-19 21:09:43,023 [INFO] ‚úÖ FORMATTING: Generated assessment with 6 sections
2025-07-19 21:09:43,023 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- Patient has a history of atopic dermatitis, which has been exacerbated since moving to a high-humidity environment in 2019, suggesting a possible environmental trigger
- Previ...
2025-07-19 21:09:49,796 [INFO] Generated allergy treatment plan
2025-07-19 21:09:56,918 [INFO] üîß FORCE CREATING structured recommendations
2025-07-19 21:09:56,918 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-19 21:09:56,918 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:09:56,918 [INFO] üîç CHECKING HPI: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which provided initial relief but later stopped working, leading to the development of new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroids, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to suspected yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin. Patient has two dogs, one adopted in February, and high IgE levels (7,323) indicating possible dog allergy.
2025-07-19 21:09:56,918 [INFO] ‚úÖ CLEAN: No problematic patterns found
2025-07-19 21:09:56,918 [INFO] üîÑ Generating structured recommendations...
2025-07-19 21:09:56,919 [INFO] üîß FORCE CREATING structured recommendations
2025-07-19 21:09:56,919 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-19 21:09:56,919 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:09:56,919 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-19 21:09:56,919 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Complete current course of prednisone as prescribed'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine'], 'FOLLOW-UP SCHEDULE': ['Return for follow-up appointment in 2 weeks', 'See primary care physician on Tuesday to discuss blood pressure medication change']}
2025-07-19 21:09:56,919 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-19 21:09:56,919 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:09:56,919 [INFO] ‚úÖ Added 5 structured recommendation categories
2025-07-19 21:09:56,919 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-19 21:09:56,973 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-19 21:09:56,990 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687c09a43ee105650cd1cf60
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:09:57,290 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:09:57,291 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:09:57,292 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:09:57,292 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:09:57,293 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:09:57,293 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:09:57,294 [INFO] Fetching history for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:09:57,297 [INFO] Retrieved 1 transcripts for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:09:57,577 [INFO] Handling GET request for /get-insights
2025-07-19 21:09:57,597 [INFO] Found 0 insights for patient 687c09843ee105650cd1cf5e using GSI
2025-07-19 21:09:57,639 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis']
2025-07-19 21:09:57,640 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-19 21:09:59,381 [WARNING] Rate limited by Semantic Scholar for '1. Atopic Dermatitis:', skipping
2025-07-19 21:10:05,218 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-19 21:10:07,219 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis
2025-07-19 21:10:09,989 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient has a history of atopic dermatitis
2025-07-19 21:10:13,737 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis
2025-07-19 21:10:15,738 [INFO] Returning 2 insights for patient 687c09843ee105650cd1cf5e
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:10:17,851 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:10:17,852 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:10:17,853 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:10:17,853 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:10:17,854 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:10:17,854 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:10:17,854 [INFO] Fetching history for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:10:17,857 [INFO] Retrieved 1 transcripts for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-19 21:10:18,496 [INFO] Handling GET request for /get-insights
2025-07-19 21:10:18,502 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019']
2025-07-19 21:10:18,503 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-19 21:10:18,513 [INFO] Found 0 insights for patient 687c08c23ee105650cd1cf5b using GSI
2025-07-19 21:10:20,202 [WARNING] Rate limited by Semantic Scholar for '1. Atopic Dermatitis:', skipping
2025-07-19 21:10:23,318 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:10:23,318 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:10:23,318 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:10:23,318 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:10:23,318 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:10:23,319 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:10:23,319 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:10:23,319 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:10:23,319 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:10:23,319 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:10:23,319 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:10:23,319 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:10:23,319 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:10:23,319 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-19 21:10:23,322 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-19 21:10:23,608 [INFO] Handling GET request for /get-insights
2025-07-19 21:10:23,612 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-19 21:10:23,613 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-19 21:10:23,630 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-19 21:10:25,316 [WARNING] Rate limited by Semantic Scholar for '1. Urticaria:', skipping
2025-07-19 21:10:25,880 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-19 21:10:27,881 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019
2025-07-19 21:10:28,881 [INFO] Simplified long condition for Semantic Scholar: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:10:29,554 [WARNING] Rate limited by Semantic Scholar for '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment', skipping
2025-07-19 21:10:30,940 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-19 21:10:32,555 [INFO] Simplified long condition to: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:10:32,941 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-19 21:10:33,398 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-19 21:10:34,646 [WARNING] Rate limited by Semantic Scholar for '- Patient experienced a single episode of urticaria lasting approximately 2 weeks', skipping
2025-07-19 21:10:35,399 [INFO] Returning 1 insights for patient 687c08c23ee105650cd1cf5b
2025-07-19 21:10:38,444 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-19 21:10:40,445 [INFO] Returning 1 insights for patient 687c0042ff973097f09d7fa5
2025-07-19 21:12:14,646 [INFO] üîç DEBUG: Authorization header present: True
2025-07-19 21:12:14,646 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Token length: 1189
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Starting token verification...
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-19 21:12:14,647 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-19 21:12:14,647 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-19 21:12:14,648 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-19 21:12:14,648 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-19 21:12:14,648 [INFO] üîç DEBUG: Token verification result: True
2025-07-19 21:12:14,648 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-19 21:12:14,648 [INFO] Fetching history for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:12:14,650 [INFO] Retrieved 1 transcripts for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-19 21:12:15,191 [INFO] Handling GET request for /get-insights
2025-07-19 21:12:15,263 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis']
2025-07-19 21:12:15,263 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-19 21:12:15,265 [INFO] Found 0 insights for patient 687c09843ee105650cd1cf5e using GSI
2025-07-19 21:12:17,571 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-19 21:12:23,979 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-19 21:12:25,980 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis
2025-07-19 21:12:27,660 [WARNING] Rate limited by Semantic Scholar for '- Patient has a history of atopic dermatitis', skipping
2025-07-19 21:12:31,410 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis
2025-07-19 21:12:33,410 [INFO] Returning 2 insights for patient 687c09843ee105650cd1cf5e
2025-07-20 16:03:57,290 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:03:57,292 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:03:57,292 [INFO] üîç DEBUG: Token length: 1195
2025-07-20 16:03:57,292 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:03:57,292 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:03:57,293 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:03:57,293 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:03:57,294 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:03:57,301 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:03:57,301 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+7@gmail.com
2025-07-20 16:03:57,301 [INFO] ‚úÖ DEBUG: Token sub: b163dd7a-10c1-7091-1165-5e4e3463d21c
2025-07-20 16:03:57,301 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:03:57,301 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+7@gmail.com', 'username': 'b163dd7a-10c1-7091-1165-5e4e3463d21c', 'sub': 'b163dd7a-10c1-7091-1165-5e4e3463d21c', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'internal', 'auth_type': 'cognito'}
2025-07-20 16:03:57,301 [INFO] Fetching patients for tenant_id: avikanak.bkr+7@gmail.com
2025-07-20 16:03:57,303 [INFO] Found 1 patients for tenant avikanak.bkr+7@gmail.com
2025-07-20 16:03:59,820 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:03:59,820 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Token length: 1195
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:03:59,821 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:03:59,821 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+7@gmail.com
2025-07-20 16:03:59,821 [INFO] ‚úÖ DEBUG: Token sub: b163dd7a-10c1-7091-1165-5e4e3463d21c
2025-07-20 16:03:59,821 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:03:59,822 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+7@gmail.com', 'username': 'b163dd7a-10c1-7091-1165-5e4e3463d21c', 'sub': 'b163dd7a-10c1-7091-1165-5e4e3463d21c', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'internal', 'auth_type': 'cognito'}
2025-07-20 16:03:59,822 [INFO] Fetching patients for tenant_id: avikanak.bkr+7@gmail.com
2025-07-20 16:03:59,824 [INFO] Found 1 patients for tenant avikanak.bkr+7@gmail.com
2025-07-20 16:32:03,215 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:32:03,215 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:32:03,216 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:32:03,216 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:32:03,216 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:32:03,216 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:32:03,217 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:32:03,217 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 16:32:03,219 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 16:32:05,209 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:32:05,210 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:32:05,210 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:32:05,210 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:32:05,210 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:32:05,211 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:32:05,211 [INFO] Fetching history for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-20 16:32:05,214 [INFO] Retrieved 1 transcripts for patient 687c09843ee105650cd1cf5e in tenant ceo@advanceai.ai
2025-07-20 16:32:05,757 [INFO] Handling GET request for /get-insights
2025-07-20 16:32:05,834 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis']
2025-07-20 16:32:05,834 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-20 16:32:05,842 [INFO] Found 0 insights for patient 687c09843ee105650cd1cf5e using GSI
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:06,793 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:32:06,794 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:32:06,794 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:32:06,794 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:32:06,794 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:32:06,794 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:32:06,795 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 16:32:06,797 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 16:32:08,132 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-20 16:32:14,457 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-20 16:32:16,458 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis
2025-07-20 16:32:18,166 [WARNING] Rate limited by Semantic Scholar for '- Patient has a history of atopic dermatitis', skipping
2025-07-20 16:32:22,969 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:32:22,970 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:32:22,970 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:32:22,970 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:32:22,971 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:32:22,971 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:32:22,971 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:32:22,971 [INFO] Fetching history for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-20 16:32:22,973 [INFO] Retrieved 1 transcripts for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-20 16:32:22,993 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis
2025-07-20 16:32:23,568 [INFO] Handling GET request for /get-insights
2025-07-20 16:32:23,572 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019']
2025-07-20 16:32:23,572 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-20 16:32:23,584 [INFO] Found 0 insights for patient 687c08c23ee105650cd1cf5b using GSI
2025-07-20 16:32:24,994 [INFO] Returning 2 insights for patient 687c09843ee105650cd1cf5e
2025-07-20 16:32:25,249 [WARNING] Rate limited by Semantic Scholar for '1. Atopic Dermatitis:', skipping
2025-07-20 16:32:30,729 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-20 16:32:32,729 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019
2025-07-20 16:32:33,730 [INFO] Simplified long condition for Semantic Scholar: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:32:34,568 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:32:37,568 [INFO] Simplified long condition to: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:32:39,467 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:32:41,468 [INFO] Returning 1 insights for patient 687c08c23ee105650cd1cf5b
2025-07-20 16:51:08,235 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-20 16:51:08,235 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-20 16:51:08,913 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-20 16:51:08,987 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-20 16:51:08,987 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-20 16:51:09,000 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-20 16:51:09,015 [INFO] MongoDB indexes created successfully
2025-07-20 16:51:09,015 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-20 16:51:34,497 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:51:34,497 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:51:34,498 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:51:34,498 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:51:34,531 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:51:34,531 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:34,531 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:34,533 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:51:34,535 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:51:34,535 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:51:34,536 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:51:34,536 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:51:34,536 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:51:34,537 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 16:51:34,539 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 16:51:37,564 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:51:37,565 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:51:37,565 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:51:37,566 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:51:37,566 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:51:37,566 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:51:37,566 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:51:37,567 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:51:37,577 [INFO] Deleted patient 687c09843ee105650cd1cf5e and associated data in tenant ceo@advanceai.ai
2025-07-20 16:51:37,790 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:51:37,790 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:51:37,790 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:51:37,791 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:51:37,791 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:51:37,791 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:37,791 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:37,791 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:51:37,792 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:51:37,792 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:51:37,792 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:51:37,792 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:51:37,792 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:51:37,792 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 16:51:37,794 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 16:51:43,474 [INFO] Handling POST request for /api/visit/start
2025-07-20 16:51:43,475 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 16:51:43,482 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 16:51:43,483 [INFO] Patient kjiui not found, creating new patient
2025-07-20 16:51:43,496 [INFO] Created new patient with ID: 687d1e9f4030303178689305
2025-07-20 16:51:43,505 [INFO] Visit started: 968001b7-8071-408e-82a0-b9b9fba09307 for patient 687d1e9f4030303178689305 by ceo@advanceai.ai
2025-07-20 16:51:45,051 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:51:45,051 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:51:45,052 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:51:45,052 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:51:45,052 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:51:45,052 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:51:45,052 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:51:45,053 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 16:51:45,055 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 16:51:45,321 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:51:45,322 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:51:45,323 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:51:45,323 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:51:45,323 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:51:45,323 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:51:45,323 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:51:45,323 [INFO] Fetching history for patient 687d1e9f4030303178689305 in tenant ceo@advanceai.ai
2025-07-20 16:51:45,325 [INFO] Retrieved 0 transcripts for patient 687d1e9f4030303178689305 in tenant ceo@advanceai.ai
2025-07-20 16:52:26,567 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-20 16:52:26,567 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 16:52:26,575 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 16:52:26,581 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 20), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 20, 16, 52, 26, 580850)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 20), of type: <class 'datetime.date'>
2025-07-20 16:52:26,581 [INFO] üìä Usage updated for ceo@advanceai.ai: 38/1000 (3.8%)
2025-07-20 16:52:27,698 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Dog Allergy', 'Drug Allergy', 'Topical Steroid Withdrawal', 'Herpes Simplex Virus Type 1']
2025-07-20 16:52:33,209 [INFO] ‚úÖ FORMATTING: Generated assessment with 5 sections
2025-07-20 16:52:33,209 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- Patient has a history of atopic dermatitis, which has been exacerbated since moving to a high-humidity environment in 2019, suggesting a possible environmental trigger
- Previ...
2025-07-20 16:52:39,910 [INFO] Generated allergy treatment plan
2025-07-20 16:52:47,076 [INFO] üîç RAW AI SOAP RESPONSE:
2025-07-20 16:52:47,077 [INFO] üîç ```json
{
    "patient_history": {
        "chief_complaint": "Severe atopic dermatitis and possible drug withdrawal symptoms",
        "history_of_present_illness": "Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.",
        "past_medical_history": "History of atopic dermatitis, herpes simplex virus type 1",
        "allergies": "Allergic to dogs (suspected), egg whites, and milk (documented from previous blood tests)",
        "social_history": "Lives with two Doberman dogs, one adopted in February. Moved to a high-humidity area in 2019. No occupational factors mentioned.",
        "review_of_systems": "Skin: Severe dermatitis with scaling and oozing, particularly on ankles. No respiratory, gastrointestinal, or other systemic symptoms reported."
    },
    "physical_examination": "Skin examination reveals widespread erythematous, scaly patches with areas of oozing, particularly on the ankles. No involvement of the face. No signs of secondary infection noted.",
    "diagnostic_workup": "Consider repeat skin biopsy if symptoms persist. Monitor IgE levels and consider specific IgE testing for dog allergens. Patch testing cancelled due to current skin condition.",
    "patient_education": "Educated patient on the importance of avoiding potential allergens, particularly dogs. Advised on the use of Medrol dose pack for symptom relief, and to continue using Vanicream HC and A&D ointment for affected areas. Discussed the potential for topical steroid withdrawal and the need to monitor symptoms closely. Advised to stop all supplements including zinc and trace minerals.",
    "follow_up_instructions": "Follow up in one month. Patient to attempt separation from dogs for 2-3 weeks, if possible, and to use a HEPA filter in the bedroom. Continue with prescribed medications and report any changes in symptoms.",
    "summary": "Patient presents with severe atopic dermatitis exacerbated since moving to a high-humidity area, with possible drug withdrawal symptoms from Rinvoq and topical steroids. High IgE levels suggest dog allergies, and patient advised to separate from dogs temporarily. Prescribed Medrol dose pack and topical treatments, with instructions to stop all supplements. Follow-up in one month to assess response to treatment and allergen avoidance."
}
```
2025-07-20 16:52:47,077 [INFO] ============================================================
2025-07-20 16:52:47,077 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-20 16:52:47,077 [INFO] üîç HPI LENGTH: 1020
2025-07-20 16:52:47,077 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,078 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-20 16:52:47,078 [INFO] ============================================================
2025-07-20 16:52:47,078 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 16:52:47,078 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-20 16:52:47,078 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 16:52:47,078 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-20 16:52:47,078 [INFO] üîç HPI LENGTH: 1020
2025-07-20 16:52:47,078 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,078 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-20 16:52:47,078 [INFO] ============================================================
2025-07-20 16:52:47,078 [INFO] üîç BEFORE REMOVAL: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,079 [INFO] üîç AFTER REMOVAL: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,079 [INFO] ‚ö†Ô∏è NO CHANGE MADE TO HPI
2025-07-20 16:52:47,080 [INFO] üîç STEP 5B - AFTER REMOVAL - ‚úÖ CLEAN
2025-07-20 16:52:47,080 [INFO] üîç HPI LENGTH: 1020
2025-07-20 16:52:47,080 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,080 [INFO] üîç STEP 5B - AFTER REMOVAL - END
2025-07-20 16:52:47,081 [INFO] ============================================================
2025-07-20 16:52:47,081 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-20 16:52:47,081 [INFO] üîç HPI LENGTH: 1020
2025-07-20 16:52:47,081 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,081 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-20 16:52:47,081 [INFO] ============================================================
2025-07-20 16:52:47,081 [INFO] ‚úÖ FINAL CHECK PASSED: HPI is clean
2025-07-20 16:52:47,082 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-20 16:52:47,082 [INFO] üîç HPI LENGTH: 1020
2025-07-20 16:52:47,082 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened significantly since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, which may have contributed to the current symptoms. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face, with the bottoms of the feet resembling the palms of the hands due to scaling. Patient has two dogs, one adopted in February, and high IgE levels (7,323) suggesting possible dog allergies.
2025-07-20 16:52:47,082 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-20 16:52:47,082 [INFO] ============================================================
2025-07-20 16:52:47,082 [INFO] üîÑ Generating structured recommendations...
2025-07-20 16:52:47,082 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 16:52:47,082 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-20 16:52:47,082 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 16:52:47,083 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-20 16:52:47,083 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Complete current course of prednisone as prescribed'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine'], 'FOLLOW-UP SCHEDULE': ['Return for follow-up appointment in 2 weeks', 'See primary care physician on Tuesday to discuss blood pressure medication change']}
2025-07-20 16:52:47,084 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-20 16:52:47,084 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 16:52:47,084 [INFO] ‚úÖ Added 5 structured recommendation categories
2025-07-20 16:52:47,085 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 16:52:47,131 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-20 16:52:47,147 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687d1edf4030303178689307
2025-07-20 16:52:47,416 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:52:47,416 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:52:47,417 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:52:47,417 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:52:47,417 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:52:47,417 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:52:47,418 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:52:47,418 [INFO] Fetching history for patient 687d1e9f4030303178689305 in tenant ceo@advanceai.ai
2025-07-20 16:52:47,421 [INFO] Retrieved 1 transcripts for patient 687d1e9f4030303178689305 in tenant ceo@advanceai.ai
2025-07-20 16:52:47,696 [INFO] Handling GET request for /get-insights
2025-07-20 16:52:47,716 [INFO] Found 0 insights for patient 687d1e9f4030303178689305 using GSI
2025-07-20 16:52:47,759 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis']
2025-07-20 16:52:47,760 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-20 16:52:50,161 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-20 16:52:56,768 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-20 16:52:58,769 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis
2025-07-20 16:53:00,477 [WARNING] Rate limited by Semantic Scholar for '- Patient has a history of atopic dermatitis', skipping
2025-07-20 16:53:04,307 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis
2025-07-20 16:53:06,308 [INFO] Returning 2 insights for patient 687d1e9f4030303178689305
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:36,361 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:57:36,362 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:57:36,362 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:57:36,363 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:57:36,363 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:57:36,364 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:57:36,364 [INFO] Fetching history for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-20 16:57:36,367 [INFO] Retrieved 1 transcripts for patient 687c08c23ee105650cd1cf5b in tenant ceo@advanceai.ai
2025-07-20 16:57:36,962 [INFO] Found 0 insights for patient 687c08c23ee105650cd1cf5b using GSI
2025-07-20 16:57:37,176 [INFO] Handling GET request for /get-insights
2025-07-20 16:57:37,181 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019']
2025-07-20 16:57:37,181 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-20 16:57:39,519 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-20 16:57:43,194 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:57:43,194 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:57:43,194 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:57:43,195 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:57:43,195 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:57:43,195 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:43,195 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:43,196 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:57:43,196 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:57:43,197 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:57:43,197 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:57:43,197 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:57:43,197 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:57:43,197 [INFO] Fetching history for patient 686bcd9041fde50b282ab6f3 in tenant ceo@advanceai.ai
2025-07-20 16:57:43,199 [INFO] Retrieved 1 transcripts for patient 686bcd9041fde50b282ab6f3 in tenant ceo@advanceai.ai
2025-07-20 16:57:43,485 [INFO] Found 0 insights for patient 686bcd9041fde50b282ab6f3 using GSI
2025-07-20 16:57:43,762 [INFO] Handling GET request for /get-insights
2025-07-20 16:57:43,766 [INFO] Simplified diagnoses for searching: ['1. Gastroesophageal Reflux Disease:', '- Patient was diagnosed with acid reflux one month ago by their primary care physician']
2025-07-20 16:57:43,767 [INFO] Processing diagnosis: 1. Gastroesophageal Reflux Disease:
2025-07-20 16:57:45,443 [WARNING] Rate limited by Semantic Scholar for '1. Gastroesophageal Reflux Disease:', skipping
2025-07-20 16:57:46,019 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-20 16:57:48,022 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019
2025-07-20 16:57:49,022 [INFO] Simplified long condition for Semantic Scholar: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:57:49,833 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:57:49,962 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 16:57:49,962 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 16:57:49,963 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 16:57:49,963 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 16:57:49,963 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 16:57:49,964 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:49,964 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 16:57:49,964 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 16:57:49,965 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 16:57:49,965 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 16:57:49,965 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 16:57:49,965 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 16:57:49,966 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 16:57:49,966 [INFO] Fetching history for patient 686762fc428346e14e0c556b in tenant ceo@advanceai.ai
2025-07-20 16:57:49,968 [INFO] Retrieved 1 transcripts for patient 686762fc428346e14e0c556b in tenant ceo@advanceai.ai
2025-07-20 16:57:50,257 [INFO] Found 0 insights for patient 686762fc428346e14e0c556b using GSI
2025-07-20 16:57:50,532 [INFO] Handling GET request for /get-insights
2025-07-20 16:57:50,537 [INFO] Simplified diagnoses for searching: ['1. Anaphylaxis:', '- Patient has a history of anaphylactic reactions to peanuts']
2025-07-20 16:57:50,537 [INFO] Processing diagnosis: 1. Anaphylaxis:
2025-07-20 16:57:52,235 [WARNING] Rate limited by Semantic Scholar for '1. Anaphylaxis:', skipping
2025-07-20 16:57:52,834 [INFO] Simplified long condition to: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:57:52,856 [INFO] Fetched 1 insights from PubMed for condition: 1. Gastroesophageal Reflux Disease:
2025-07-20 16:57:53,656 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 16:57:54,857 [INFO] Processing diagnosis: - Patient was diagnosed with acid reflux one month ago by their primary care physician
2025-07-20 16:57:55,657 [INFO] Returning 2 insights for patient 687c08c23ee105650cd1cf5b
2025-07-20 16:57:56,553 [WARNING] Rate limited by Semantic Scholar for '- Patient was diagnosed with acid reflux one month ago by their primary care physician', skipping
2025-07-20 16:57:58,408 [INFO] Fetched 1 insights from PubMed for condition: 1. Anaphylaxis:
2025-07-20 16:58:00,409 [INFO] Processing diagnosis: - Patient has a history of anaphylactic reactions to peanuts
2025-07-20 16:58:00,484 [WARNING] No PubMed articles found for condition: - Patient was diagnosed with acid reflux one month ago by their primary care physician
2025-07-20 16:58:02,213 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient has a history of anaphylactic reactions to peanuts
2025-07-20 16:58:02,485 [INFO] Returning 1 insights for patient 686bcd9041fde50b282ab6f3
2025-07-20 16:58:05,980 [WARNING] No PubMed articles found for condition: - Patient has a history of anaphylactic reactions to peanuts
2025-07-20 16:58:07,980 [INFO] Returning 2 insights for patient 686762fc428346e14e0c556b
2025-07-20 17:09:00,911 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-20 17:09:00,912 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-20 17:09:01,016 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-20 17:09:01,086 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-20 17:09:01,087 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-20 17:09:01,096 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-20 17:09:01,111 [INFO] MongoDB indexes created successfully
2025-07-20 17:09:01,112 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-20 17:09:34,184 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:34,185 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:34,185 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:34,186 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:34,224 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:34,224 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:34,225 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:34,225 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:34,227 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:34,227 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:34,227 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:34,227 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:34,228 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:34,228 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:09:34,230 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:09:38,426 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:38,426 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:38,426 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:38,426 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:38,427 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:38,427 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:38,427 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:38,427 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:38,427 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:38,428 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:38,428 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:38,428 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:38,428 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:38,428 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:09:38,430 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:09:41,522 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:41,522 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:41,523 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:41,523 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:41,523 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:41,524 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:41,524 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:41,524 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:41,525 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:41,525 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:41,525 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:41,525 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:41,525 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:41,535 [INFO] Deleted patient 687d1e9f4030303178689305 and associated data in tenant ceo@advanceai.ai
2025-07-20 17:09:46,177 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:46,177 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:46,178 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:46,178 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:46,178 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:46,178 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:46,180 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:46,190 [INFO] Deleted patient 687c08c23ee105650cd1cf5b and associated data in tenant ceo@advanceai.ai
2025-07-20 17:09:53,508 [INFO] Handling POST request for /api/visit/start
2025-07-20 17:09:53,508 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:09:53,514 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:09:53,515 [INFO] Patient kikiklp not found, creating new patient
2025-07-20 17:09:53,518 [INFO] Created new patient with ID: 687d22e10e3e2635265a163b
2025-07-20 17:09:53,522 [INFO] Visit started: 5200ad11-4fce-459c-8d78-d2176796425e for patient 687d22e10e3e2635265a163b by ceo@advanceai.ai
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:54,810 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:54,811 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:54,811 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:54,812 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:54,812 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:54,812 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:54,813 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:54,813 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:09:54,815 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 17:09:55,100 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:09:55,100 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:09:55,101 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:09:55,101 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:09:55,101 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:09:55,101 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:09:55,102 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:09:55,102 [INFO] Fetching history for patient 687d22e10e3e2635265a163b in tenant ceo@advanceai.ai
2025-07-20 17:09:55,105 [INFO] Retrieved 0 transcripts for patient 687d22e10e3e2635265a163b in tenant ceo@advanceai.ai
2025-07-20 17:10:07,209 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-20 17:10:07,209 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:10:07,214 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:10:07,220 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 20), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 20, 17, 10, 7, 220274)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 20), of type: <class 'datetime.date'>
2025-07-20 17:10:07,221 [INFO] üìä Usage updated for ceo@advanceai.ai: 39/1000 (3.9%)
2025-07-20 17:10:08,123 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Dog Allergy', 'Drug Allergy', 'Topical Steroid Withdrawal']
2025-07-20 17:10:12,731 [INFO] ‚úÖ FORMATTING: Generated assessment with 4 sections
2025-07-20 17:10:12,731 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019, suggesting environmental factors may play a role in symptom severit...
2025-07-20 17:10:18,407 [INFO] Generated allergy treatment plan
2025-07-20 17:10:26,661 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-20 17:10:26,662 [INFO] üìù Full response length: 3794
2025-07-20 17:10:26,662 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-20 17:10:26,662 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-20 17:10:26,662 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-20 17:10:26,663 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-20 17:10:26,663 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-20 17:10:26,663 [INFO] ============================================================
2025-07-20 17:10:26,663 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-20 17:10:26,664 [INFO] üîç HPI LENGTH: 1105
2025-07-20 17:10:26,664 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,664 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-20 17:10:26,664 [INFO] ============================================================
2025-07-20 17:10:26,664 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:10:26,664 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-20 17:10:26,664 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 17:10:26,664 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-20 17:10:26,664 [INFO] üîç HPI LENGTH: 1105
2025-07-20 17:10:26,664 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,664 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-20 17:10:26,664 [INFO] ============================================================
2025-07-20 17:10:26,664 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,668 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,669 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-20 17:10:26,669 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-20 17:10:26,669 [INFO] üîç HPI LENGTH: 1105
2025-07-20 17:10:26,669 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,670 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-20 17:10:26,670 [INFO] ============================================================
2025-07-20 17:10:26,670 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-20 17:10:26,671 [INFO] üîç HPI LENGTH: 1105
2025-07-20 17:10:26,671 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,671 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-20 17:10:26,671 [INFO] ============================================================
2025-07-20 17:10:26,672 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-20 17:10:26,672 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-20 17:10:26,672 [INFO] üîç HPI LENGTH: 1105
2025-07-20 17:10:26,672 [INFO] üîç HPI CONTENT: Patient reports severe atopic dermatitis that has worsened since moving to a high-humidity area in 2019. Initially managed with Dupixent, which did not work, followed by Rinvoq, which initially provided relief but later stopped working and led to new patches of dermatitis. After discontinuing Rinvoq, patient experienced symptoms suggestive of withdrawal, including a sensation of chemical burn across the body. Dermatologist prescribed two rounds of antibiotics and prednisone, as well as topical steroid cream, but these treatments were not effective. Patient also started valacyclovir and fluconazole recently due to a possible yeast infection following antibiotic use, but these have not provided relief. Skin biopsy showed spongiotic dermatitis with fluid trapped in the skin, affecting the patient from head to toe, excluding the face. Patient suspects that the worsening of symptoms may be related to withdrawal from Rinvoq and possibly topical steroids. Additionally, patient has two dogs, one adopted in February, and high IgE levels suggest possible dog allergies contributing to the condition.
2025-07-20 17:10:26,672 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-20 17:10:26,673 [INFO] ============================================================
2025-07-20 17:10:26,673 [INFO] üîÑ Generating structured recommendations...
2025-07-20 17:10:26,674 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:10:26,674 [INFO] ‚úÖ Generated 5 recommendation categories
2025-07-20 17:10:26,674 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 17:10:26,675 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-20 17:10:26,675 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Complete current course of prednisone as prescribed'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine'], 'FOLLOW-UP SCHEDULE': ['Return for follow-up appointment in 2 weeks', 'See primary care physician on Tuesday to discuss blood pressure medication change']}
2025-07-20 17:10:26,675 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-20 17:10:26,675 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 17:10:26,675 [INFO] ‚úÖ Added 5 structured recommendation categories
2025-07-20 17:10:26,675 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES', 'FOLLOW-UP SCHEDULE']
2025-07-20 17:10:26,723 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-20 17:10:26,738 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687d23020e3e2635265a163d
2025-07-20 17:10:27,011 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:10:27,012 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:10:27,013 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:10:27,013 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:10:27,013 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:10:27,014 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:10:27,014 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:10:27,014 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:10:27,014 [INFO] Fetching history for patient 687d22e10e3e2635265a163b in tenant ceo@advanceai.ai
2025-07-20 17:10:27,016 [INFO] Retrieved 1 transcripts for patient 687d22e10e3e2635265a163b in tenant ceo@advanceai.ai
2025-07-20 17:10:27,322 [INFO] Handling GET request for /get-insights
2025-07-20 17:10:27,322 [INFO] Found 0 insights for patient 687d22e10e3e2635265a163b using GSI
2025-07-20 17:10:27,328 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019']
2025-07-20 17:10:27,329 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-20 17:10:29,727 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-20 17:10:36,288 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-20 17:10:38,289 [INFO] Processing diagnosis: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment in 2019
2025-07-20 17:10:39,290 [INFO] Simplified long condition for Semantic Scholar: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 17:10:40,130 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 17:10:43,131 [INFO] Simplified long condition to: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 17:10:44,004 [WARNING] No PubMed articles found for condition: - Patient has a history of atopic dermatitis exacerbated since moving to a high-humidity environment
2025-07-20 17:10:46,005 [INFO] Returning 2 insights for patient 687d22e10e3e2635265a163b
2025-07-20 17:15:45,051 [INFO] Handling POST request for /api/visit/start
2025-07-20 17:15:45,052 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:15:45,058 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:15:45,060 [INFO] Patient testytyu not found, creating new patient
2025-07-20 17:15:45,066 [INFO] Created new patient with ID: 687d24410e3e2635265a163e
2025-07-20 17:15:45,072 [INFO] Visit started: 4bac9927-25ca-429f-94fa-f1d4116bf9aa for patient 687d24410e3e2635265a163e by ceo@advanceai.ai
2025-07-20 17:15:46,417 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:15:46,418 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:15:46,418 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:15:46,418 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:15:46,419 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:15:46,420 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:15:46,421 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:15:46,421 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:15:46,421 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:15:46,422 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:15:46,422 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:15:46,422 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:15:46,423 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:15:46,423 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:15:46,425 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:15:46,702 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:15:46,702 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:15:46,703 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:15:46,703 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:15:46,703 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:15:46,704 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:15:46,704 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:15:46,704 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:15:46,705 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:15:46,705 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:15:46,705 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:15:46,705 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:15:46,705 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:15:46,705 [INFO] Fetching history for patient 687d24410e3e2635265a163e in tenant ceo@advanceai.ai
2025-07-20 17:15:46,707 [INFO] Retrieved 0 transcripts for patient 687d24410e3e2635265a163e in tenant ceo@advanceai.ai
2025-07-20 17:16:01,978 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-20 17:16:01,978 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:16:01,984 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:16:01,994 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 20), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 20, 17, 16, 1, 994159)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 20), of type: <class 'datetime.date'>
2025-07-20 17:16:01,994 [INFO] üìä Usage updated for ceo@advanceai.ai: 40/1000 (4.0%)
2025-07-20 17:16:02,854 [INFO] Extracted allergy conditions: ['Chronic Sinusitis', 'Possible Immunodeficiency', 'Allergy to Dust Mites']
2025-07-20 17:16:06,309 [INFO] ‚úÖ FORMATTING: Generated assessment with 3 sections
2025-07-20 17:16:06,310 [INFO] Generated allergy assessment: 1. Chronic Sinusitis:

- Patient reports chronic sinus infections for the past 10 years, indicating a long-standing issue with recurrent sinusitis
- The patient has been prescribed antibiotics for sin...
2025-07-20 17:16:12,004 [INFO] Generated allergy treatment plan
2025-07-20 17:16:18,265 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-20 17:16:18,265 [INFO] üìù Full response length: 2921
2025-07-20 17:16:18,266 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-20 17:16:18,266 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-20 17:16:18,266 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-20 17:16:18,266 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-20 17:16:18,266 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-20 17:16:18,266 [INFO] ============================================================
2025-07-20 17:16:18,267 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-20 17:16:18,267 [INFO] üîç HPI LENGTH: 634
2025-07-20 17:16:18,267 [INFO] üîç HPI CONTENT: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,267 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-20 17:16:18,267 [INFO] ============================================================
2025-07-20 17:16:18,267 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:16:18,267 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 17:16:18,267 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:16:18,267 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-20 17:16:18,267 [INFO] üîç HPI LENGTH: 634
2025-07-20 17:16:18,267 [INFO] üîç HPI CONTENT: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,267 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-20 17:16:18,267 [INFO] ============================================================
2025-07-20 17:16:18,267 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,268 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,269 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-20 17:16:18,269 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-20 17:16:18,269 [INFO] üîç HPI LENGTH: 634
2025-07-20 17:16:18,270 [INFO] üîç HPI CONTENT: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,270 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-20 17:16:18,270 [INFO] ============================================================
2025-07-20 17:16:18,270 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-20 17:16:18,271 [INFO] üîç HPI LENGTH: 634
2025-07-20 17:16:18,271 [INFO] üîç HPI CONTENT: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,271 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-20 17:16:18,271 [INFO] ============================================================
2025-07-20 17:16:18,272 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-20 17:16:18,272 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-20 17:16:18,272 [INFO] üîç HPI LENGTH: 634
2025-07-20 17:16:18,272 [INFO] üîç HPI CONTENT: Patient has been experiencing chronic sinus infections for the past 10 years. An ENT specialist recommended blood work to investigate potential immunological causes. The patient's father had an autoimmune disorder. Recent blood tests showed normal immunoglobulin levels (IgM, IgG, IgA) but low CD19 cells at 88 (normal range 110-660). The patient has not been on chronic steroids or immunosuppressants. The ENT also noted a blockage in the left sinus and suggested another surgery, but the patient wanted to wait for the blood results. Additionally, the patient has been getting UTIs and a CT scan showed swelling in the right kidney.
2025-07-20 17:16:18,272 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-20 17:16:18,272 [INFO] ============================================================
2025-07-20 17:16:18,272 [INFO] üîÑ Generating structured recommendations...
2025-07-20 17:16:18,272 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:16:18,273 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 17:16:18,273 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:16:18,273 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-20 17:16:18,273 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Complete current course of prednisone as prescribed'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-20 17:16:18,273 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-20 17:16:18,273 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:16:18,273 [INFO] ‚úÖ Added 3 structured recommendation categories
2025-07-20 17:16:18,273 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:16:18,325 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-20 17:16:18,341 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687d24620e3e2635265a1640
2025-07-20 17:16:18,617 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:16:18,618 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:16:18,619 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:16:18,619 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:16:18,619 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:16:18,619 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:16:18,620 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:16:18,620 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:16:18,621 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:16:18,621 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:16:18,621 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:16:18,621 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:16:18,621 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:16:18,622 [INFO] Fetching history for patient 687d24410e3e2635265a163e in tenant ceo@advanceai.ai
2025-07-20 17:16:18,624 [INFO] Retrieved 1 transcripts for patient 687d24410e3e2635265a163e in tenant ceo@advanceai.ai
2025-07-20 17:16:18,913 [INFO] Found 0 insights for patient 687d24410e3e2635265a163e using GSI
2025-07-20 17:16:19,174 [INFO] Handling GET request for /get-insights
2025-07-20 17:16:19,178 [INFO] Simplified diagnoses for searching: ['1. Chronic Sinusitis:', '- Patient reports chronic sinus infections for the past 10 years']
2025-07-20 17:16:19,179 [INFO] Processing diagnosis: 1. Chronic Sinusitis:
2025-07-20 17:16:20,888 [WARNING] Rate limited by Semantic Scholar for '1. Chronic Sinusitis:', skipping
2025-07-20 17:16:27,349 [INFO] Fetched 1 insights from PubMed for condition: 1. Chronic Sinusitis:
2025-07-20 17:16:29,350 [INFO] Processing diagnosis: - Patient reports chronic sinus infections for the past 10 years
2025-07-20 17:16:31,025 [WARNING] Rate limited by Semantic Scholar for '- Patient reports chronic sinus infections for the past 10 years', skipping
2025-07-20 17:16:36,865 [INFO] Fetched 0 insights from PubMed for condition: - Patient reports chronic sinus infections for the past 10 years
2025-07-20 17:16:38,866 [INFO] Returning 1 insights for patient 687d24410e3e2635265a163e
2025-07-20 17:22:58,969 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:22:58,971 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:22:58,971 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:22:58,971 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:22:58,972 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:22:58,972 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:22:58,972 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:22:58,972 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:22:58,972 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:22:58,972 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:22:58,972 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:22:58,972 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:22:58,972 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:22:58,973 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:22:58,975 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:23:03,192 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:03,193 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:23:03,193 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:23:03,193 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:23:03,193 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:23:03,194 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:23:03,194 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:23:03,195 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:23:03,195 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:23:03,195 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:23:03,195 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:23:03,195 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:23:03,196 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:23:03,196 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:03,196 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:03,196 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:23:03,196 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:23:03,196 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:23:03,196 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:23:03,196 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:23:03,196 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:23:03,199 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:23:03,217 [INFO] Deleted patient 687d24410e3e2635265a163e and associated data in tenant ceo@advanceai.ai
2025-07-20 17:23:08,218 [INFO] Handling POST request for /api/visit/start
2025-07-20 17:23:08,218 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:23:08,223 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:23:08,225 [INFO] Patient pankja not found, creating new patient
2025-07-20 17:23:08,228 [INFO] Created new patient with ID: 687d25fc0e3e2635265a1641
2025-07-20 17:23:08,231 [INFO] Visit started: 24896ba1-49a0-4ff9-87bd-81a59470145e for patient 687d25fc0e3e2635265a1641 by ceo@advanceai.ai
2025-07-20 17:23:09,710 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:23:09,710 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:23:09,710 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:23:09,710 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:23:09,710 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:23:09,711 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:09,711 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:09,711 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:23:09,711 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:23:09,711 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:23:09,712 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:23:09,712 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:23:09,712 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:23:09,712 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:23:09,714 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:23:10,030 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:10,031 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:23:10,031 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:23:10,031 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:23:10,032 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:23:10,032 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:23:10,032 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:23:10,032 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:23:10,032 [INFO] Fetching history for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:23:10,033 [INFO] Retrieved 0 transcripts for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:23:42,273 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-20 17:23:42,273 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 17:23:42,278 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 17:23:42,284 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 20), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 20, 17, 23, 42, 283935)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 20), of type: <class 'datetime.date'>
2025-07-20 17:23:42,284 [INFO] üìä Usage updated for ceo@advanceai.ai: 41/1000 (4.1%)
2025-07-20 17:23:43,446 [INFO] Extracted allergy conditions: ['Dexamethasone Allergy', 'Methylprednisolone Allergy', 'Shellfish Allergy', 'Urticaria', 'Angioedema', 'Allergic Rhinitis', 'Dermatographism']
2025-07-20 17:23:49,999 [INFO] ‚úÖ FORMATTING: Generated assessment with 7 sections
2025-07-20 17:23:49,999 [INFO] Generated allergy assessment: 1. Dexamethasone Allergy:

- Patient reports a history of localized hives following an iontophoretic administration of dexamethasone, indicating a type I hypersensitivity reaction
- The reaction occur...
2025-07-20 17:23:56,688 [INFO] Generated allergy treatment plan
2025-07-20 17:24:03,118 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-20 17:24:03,119 [INFO] üìù Full response length: 3009
2025-07-20 17:24:03,119 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] ============================================================
2025-07-20 17:24:03,120 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-20 17:24:03,120 [INFO] üîç HPI LENGTH: 927
2025-07-20 17:24:03,120 [INFO] üîç HPI CONTENT: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,121 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-20 17:24:03,121 [INFO] ============================================================
2025-07-20 17:24:03,121 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:24:03,122 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 17:24:03,122 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:24:03,122 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-20 17:24:03,122 [INFO] üîç HPI LENGTH: 927
2025-07-20 17:24:03,122 [INFO] üîç HPI CONTENT: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,122 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-20 17:24:03,122 [INFO] ============================================================
2025-07-20 17:24:03,122 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,124 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,124 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-20 17:24:03,124 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-20 17:24:03,125 [INFO] üîç HPI LENGTH: 927
2025-07-20 17:24:03,125 [INFO] üîç HPI CONTENT: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,126 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-20 17:24:03,126 [INFO] ============================================================
2025-07-20 17:24:03,126 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-20 17:24:03,126 [INFO] üîç HPI LENGTH: 927
2025-07-20 17:24:03,127 [INFO] üîç HPI CONTENT: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,127 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-20 17:24:03,127 [INFO] ============================================================
2025-07-20 17:24:03,127 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-20 17:24:03,127 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-20 17:24:03,127 [INFO] üîç HPI LENGTH: 927
2025-07-20 17:24:03,127 [INFO] üîç HPI CONTENT: Last August, the patient had an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoresis treatment, the patient was advised against taking the Medrol Pak. However, upon opening the Medrol Pak for her husband, the patient experienced right-sided tongue swelling without ingestion, which resolved after taking Benadryl. This was a unique incident for the patient. Additionally, about 10 years ago, the patient experienced a severe itching reaction after consuming shrimp, describing it as feeling like ants were poured over her head. Subsequent exposure to shrimp, even through touch, caused burning sensations in her fingers. The patient avoids all seafood due to these reactions and has not been tested for shellfish allergies since an initial blood test that returned negative despite continued reactions.
2025-07-20 17:24:03,127 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-20 17:24:03,127 [INFO] ============================================================
2025-07-20 17:24:03,128 [INFO] üîÑ Generating structured recommendations...
2025-07-20 17:24:03,128 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 17:24:03,129 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 17:24:03,129 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:24:03,129 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-20 17:24:03,129 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Continue iron supplementation for anemia'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-20 17:24:03,130 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-20 17:24:03,130 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:24:03,130 [INFO] ‚úÖ Added 3 structured recommendation categories
2025-07-20 17:24:03,130 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 17:24:03,184 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-20 17:24:03,190 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687d26330e3e2635265a1643
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:24:03,487 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:24:03,488 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:24:03,488 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:24:03,488 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:24:03,488 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:24:03,488 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:24:03,488 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:24:03,488 [INFO] Fetching history for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:24:03,491 [INFO] Retrieved 1 transcripts for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:24:03,802 [INFO] Handling GET request for /get-insights
2025-07-20 17:24:03,808 [INFO] Simplified diagnoses for searching: ['1. Dexamethasone Allergy:', '- Patient reports a history of localized hives following an iontophoretic administration of dexamethasone']
2025-07-20 17:24:03,809 [INFO] Processing diagnosis: 1. Dexamethasone Allergy:
2025-07-20 17:24:03,855 [INFO] Found 0 insights for patient 687d25fc0e3e2635265a1641 using GSI
2025-07-20 17:24:05,569 [WARNING] Rate limited by Semantic Scholar for '1. Dexamethasone Allergy:', skipping
2025-07-20 17:24:11,526 [INFO] Fetched 1 insights from PubMed for condition: 1. Dexamethasone Allergy:
2025-07-20 17:24:13,527 [INFO] Processing diagnosis: - Patient reports a history of localized hives following an iontophoretic administration of dexamethasone
2025-07-20 17:24:14,528 [INFO] Simplified long condition for Semantic Scholar: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:24:15,232 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a history of localized hives following an iontophoretic administration of dexameth', skipping
2025-07-20 17:24:18,233 [INFO] Simplified long condition to: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:24:19,078 [WARNING] No PubMed articles found for condition: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:24:21,079 [INFO] Returning 1 insights for patient 687d25fc0e3e2635265a1641
2025-07-20 17:26:44,432 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:26:44,432 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:26:44,432 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:26:44,433 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:26:44,433 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:26:44,433 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:26:44,433 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:26:44,433 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:26:44,434 [INFO] Fetching history for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:26:44,437 [INFO] Retrieved 1 transcripts for patient 687d25fc0e3e2635265a1641 in tenant ceo@advanceai.ai
2025-07-20 17:26:44,984 [INFO] Handling GET request for /get-insights
2025-07-20 17:26:45,028 [INFO] Simplified diagnoses for searching: ['1. Dexamethasone Allergy:', '- Patient reports a history of localized hives following an iontophoretic administration of dexamethasone']
2025-07-20 17:26:45,029 [INFO] Processing diagnosis: 1. Dexamethasone Allergy:
2025-07-20 17:26:47,384 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Dexamethasone Allergy:
2025-07-20 17:26:53,047 [INFO] Fetched 1 insights from PubMed for condition: 1. Dexamethasone Allergy:
2025-07-20 17:26:55,048 [INFO] Processing diagnosis: - Patient reports a history of localized hives following an iontophoretic administration of dexamethasone
2025-07-20 17:26:56,049 [INFO] Simplified long condition for Semantic Scholar: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:26:56,951 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:26:59,952 [INFO] Simplified long condition to: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:27:00,800 [WARNING] No PubMed articles found for condition: - Patient reports a history of localized hives following an iontophoretic administration of dexameth
2025-07-20 17:27:02,801 [INFO] Returning 2 insights for patient 687d25fc0e3e2635265a1641
2025-07-20 17:27:56,341 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:27:56,341 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:27:56,341 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:27:56,341 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:27:56,342 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:27:56,342 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:56,342 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:56,342 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:27:56,343 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:27:56,343 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:27:56,343 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:27:56,343 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:27:56,343 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:27:56,343 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:27:56,344 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-20 17:27:59,400 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:27:59,400 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:27:59,401 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:27:59,401 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:27:59,401 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:27:59,401 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:59,402 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:59,402 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:27:59,402 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:27:59,403 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:27:59,403 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:27:59,403 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:27:59,403 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:27:59,405 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:27:59,405 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:27:59,405 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:27:59,405 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:27:59,406 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:27:59,406 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:59,406 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:27:59,406 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:27:59,407 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:27:59,407 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:27:59,407 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:27:59,408 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:27:59,408 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:27:59,409 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 17:27:59,415 [INFO] Deleted patient 687d25fc0e3e2635265a1641 and associated data in tenant ceo@advanceai.ai
2025-07-20 17:27:59,420 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 17:28:03,795 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 17:28:03,795 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 17:28:03,796 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 17:28:03,796 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 17:28:03,796 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 17:28:03,796 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 17:28:03,797 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 17:28:03,807 [INFO] Deleted patient 687d22e10e3e2635265a163b and associated data in tenant ceo@advanceai.ai
2025-07-20 18:34:04,198 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:04,199 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:34:04,200 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:34:04,200 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:34:04,201 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:34:04,201 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:34:04,201 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:34:04,202 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 18:34:04,204 [INFO] Found 4 patients for tenant ceo@advanceai.ai
2025-07-20 18:34:06,037 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:34:06,037 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:34:06,037 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:34:06,037 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:34:06,037 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:34:06,038 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:06,038 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:06,038 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:34:06,039 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:34:06,039 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:34:06,039 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:34:06,039 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:34:06,039 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:34:06,040 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 18:34:06,042 [INFO] Found 4 patients for tenant ceo@advanceai.ai
2025-07-20 18:34:50,970 [INFO] Handling POST request for /api/visit/start
2025-07-20 18:34:50,970 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 18:34:50,976 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 18:34:50,978 [INFO] Patient Medora-Test not found, creating new patient
2025-07-20 18:34:50,980 [INFO] Created new patient with ID: 687d36ca0e3e2635265a1644
2025-07-20 18:34:50,983 [INFO] Visit started: 2a81e26d-f574-472a-b47f-928925f6af01 for patient 687d36ca0e3e2635265a1644 by ceo@advanceai.ai
2025-07-20 18:34:53,181 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:34:53,182 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:34:53,182 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:34:53,182 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:34:53,182 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:34:53,182 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:34:53,183 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 18:34:53,185 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 18:34:53,464 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:34:53,464 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:34:53,464 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:34:53,464 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:34:53,465 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:34:53,465 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:53,465 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:34:53,465 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:34:53,466 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:34:53,466 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:34:53,467 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:34:53,467 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:34:53,467 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:34:53,467 [INFO] Fetching history for patient 687d36ca0e3e2635265a1644 in tenant ceo@advanceai.ai
2025-07-20 18:34:53,469 [INFO] Retrieved 0 transcripts for patient 687d36ca0e3e2635265a1644 in tenant ceo@advanceai.ai
2025-07-20 18:35:11,336 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:11,337 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:35:11,337 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:35:11,337 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:35:11,337 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:35:11,338 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:35:11,338 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:35:11,348 [INFO] Deleted patient 687d36ca0e3e2635265a1644 and associated data in tenant ceo@advanceai.ai
2025-07-20 18:35:42,747 [INFO] Handling POST request for /api/visit/start
2025-07-20 18:35:42,748 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 18:35:42,753 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 18:35:42,755 [INFO] Patient Medora Test not found, creating new patient
2025-07-20 18:35:42,758 [INFO] Created new patient with ID: 687d36fe0e3e2635265a1646
2025-07-20 18:35:42,762 [INFO] Visit started: a38c256a-4bfc-44d9-9716-6cc1b5abc499 for patient 687d36fe0e3e2635265a1646 by ceo@advanceai.ai
2025-07-20 18:35:44,290 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:44,291 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:35:44,292 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:35:44,292 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:35:44,292 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:35:44,292 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:35:44,292 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:35:44,292 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 18:35:44,294 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 18:35:44,625 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:35:44,626 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:35:44,626 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:35:44,626 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:35:44,626 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:35:44,627 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:44,627 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:35:44,627 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:35:44,628 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:35:44,628 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:35:44,628 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:35:44,628 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:35:44,628 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:35:44,629 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 18:35:44,631 [INFO] Retrieved 0 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 18:36:42,229 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-20 18:36:42,229 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-20 18:36:42,234 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-20 18:36:42,241 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 20), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 20, 18, 36, 42, 240277)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 20), of type: <class 'datetime.date'>
2025-07-20 18:36:42,241 [INFO] üìä Usage updated for ceo@advanceai.ai: 42/1000 (4.2%)
2025-07-20 18:36:43,464 [INFO] Extracted allergy conditions: ['Urticaria', 'Allergic Rhinitis', 'Food Allergy', 'Contact Dermatitis', 'Angioedema', 'Dermatographism']
2025-07-20 18:36:47,613 [INFO] ‚úÖ FORMATTING: Generated assessment with 6 sections
2025-07-20 18:36:47,614 [INFO] Generated allergy assessment: 1. Urticaria:

- Patient reports a history of hives following an injection of dexamethasone, indicating a possible IgE-mediated reaction to the corticosteroid
- Childhood history of hives, suggesting ...
2025-07-20 18:36:53,616 [INFO] Generated allergy treatment plan
2025-07-20 18:36:59,215 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-20 18:36:59,215 [INFO] üìù Full response length: 2589
2025-07-20 18:36:59,216 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] ============================================================
2025-07-20 18:36:59,216 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-20 18:36:59,216 [INFO] üîç HPI LENGTH: 601
2025-07-20 18:36:59,216 [INFO] üîç HPI CONTENT: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,216 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-20 18:36:59,216 [INFO] ============================================================
2025-07-20 18:36:59,217 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 18:36:59,217 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 18:36:59,217 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 18:36:59,218 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-20 18:36:59,218 [INFO] üîç HPI LENGTH: 601
2025-07-20 18:36:59,221 [INFO] üîç HPI CONTENT: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,221 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-20 18:36:59,221 [INFO] ============================================================
2025-07-20 18:36:59,221 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,223 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,223 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-20 18:36:59,223 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-20 18:36:59,223 [INFO] üîç HPI LENGTH: 601
2025-07-20 18:36:59,223 [INFO] üîç HPI CONTENT: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,223 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-20 18:36:59,223 [INFO] ============================================================
2025-07-20 18:36:59,223 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-20 18:36:59,224 [INFO] üîç HPI LENGTH: 601
2025-07-20 18:36:59,224 [INFO] üîç HPI CONTENT: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,224 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-20 18:36:59,224 [INFO] ============================================================
2025-07-20 18:36:59,224 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-20 18:36:59,224 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-20 18:36:59,224 [INFO] üîç HPI LENGTH: 601
2025-07-20 18:36:59,224 [INFO] üîç HPI CONTENT: Last August, the patient experienced an upper respiratory infection and was prescribed a Z-Pak and a Medrol Pak. Despite a known allergy to dexamethasone, which previously caused localized hives after an iontophoretic delivery, the patient touched the Medrol Pak to open it for her husband and subsequently experienced swelling on the right side of her tongue. This reaction resolved after taking Benadryl. Additionally, the patient reports a suspected shellfish allergy following an itchy reaction to shrimp about 10 years ago, and more recently, burning fingers after peeling shrimp for her husband.
2025-07-20 18:36:59,224 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-20 18:36:59,224 [INFO] ============================================================
2025-07-20 18:36:59,224 [INFO] üîÑ Generating structured recommendations...
2025-07-20 18:36:59,226 [INFO] üîß FORCE CREATING structured recommendations
2025-07-20 18:36:59,226 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-20 18:36:59,226 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 18:36:59,226 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-20 18:36:59,227 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Continue iron supplementation for anemia'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-20 18:36:59,227 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-20 18:36:59,227 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 18:36:59,227 [INFO] ‚úÖ Added 3 structured recommendation categories
2025-07-20 18:36:59,228 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-20 18:36:59,272 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-20 18:36:59,278 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687d374b0e3e2635265a1648
2025-07-20 18:36:59,554 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:36:59,555 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 18:36:59,556 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 18:36:59,556 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 18:36:59,556 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 18:36:59,556 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 18:36:59,556 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 18:36:59,556 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 18:36:59,556 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 18:36:59,558 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 18:36:59,881 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 18:37:00,151 [INFO] Handling GET request for /get-insights
2025-07-20 18:37:00,156 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 18:37:00,156 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 18:37:02,582 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 18:37:09,066 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 18:37:11,067 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 18:37:12,919 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 18:37:18,649 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 18:37:20,650 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:36:40,366 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:36:40,366 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:36:40,366 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:36:40,366 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:36:40,366 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:36:40,367 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:40,367 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:40,367 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:36:40,367 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:36:40,367 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:36:40,367 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:36:40,367 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:36:40,367 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:36:40,367 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:36:40,369 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:36:43,144 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:36:43,144 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:36:43,145 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:36:43,145 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:36:43,145 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:36:43,145 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:36:43,145 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:36:43,146 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:36:43,148 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:36:49,115 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:36:49,116 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:36:49,116 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:36:49,116 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:36:49,116 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:36:49,116 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:36:49,116 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:36:49,118 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:36:49,669 [INFO] Handling GET request for /get-insights
2025-07-20 22:36:49,738 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:36:49,738 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:36:49,753 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 22:36:51,696 [WARNING] Rate limited by Semantic Scholar for '1. Urticaria:', skipping
2025-07-20 22:36:57,823 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:36:59,823 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:37:01,520 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a history of hives following an injection of dexamethasone', skipping
2025-07-20 22:37:08,427 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:37:10,428 [INFO] Returning 2 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:42:06,960 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:42:06,960 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:42:06,960 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:42:06,960 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:42:06,960 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:42:06,961 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:06,961 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:06,961 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:42:06,961 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:42:06,961 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:42:06,961 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:42:06,961 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:42:06,961 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:42:06,961 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:06,963 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:07,502 [INFO] Handling GET request for /get-insights
2025-07-20 22:42:07,549 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:42:07,549 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:42:09,946 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 22:42:16,056 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:42:18,057 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:42:20,128 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:42:25,852 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:42:27,852 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:42:47,454 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:42:47,454 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:42:47,454 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:42:47,454 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:42:47,455 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:42:47,455 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:47,455 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:47,455 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:42:47,455 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:42:47,455 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:42:47,455 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:42:47,455 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:42:47,455 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:42:47,456 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:47,458 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:48,045 [INFO] Handling GET request for /get-insights
2025-07-20 22:42:48,049 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:42:48,049 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:42:50,978 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 22:42:53,284 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:42:53,284 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:42:53,284 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:42:53,284 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:42:53,285 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:42:53,285 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:53,285 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:42:53,285 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:42:53,285 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:42:53,285 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:42:53,285 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:42:53,285 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:42:53,285 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:42:53,285 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:53,288 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:42:56,826 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:42:58,827 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:00,682 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:06,427 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:08,428 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:43:08,773 [INFO] Handling GET request for /get-insights
2025-07-20 22:43:08,777 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:43:08,777 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:43:11,199 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 22:43:16,920 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:43:18,920 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:20,726 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:26,434 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:43:28,435 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:45:19,249 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:45:19,249 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:19,250 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:45:19,251 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:45:19,251 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:45:19,251 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:45:19,251 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:45:19,251 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:45:19,251 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:45:19,253 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:45:21,776 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:45:21,776 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:45:21,777 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:45:21,777 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:45:21,777 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:45:21,778 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:21,778 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:21,778 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:45:21,781 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:45:21,781 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:45:21,782 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:45:21,782 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:45:21,782 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:45:21,783 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:45:21,784 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:45:31,988 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:45:31,988 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:45:31,988 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:45:31,988 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:45:31,989 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:45:31,989 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:31,989 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:45:31,989 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:45:31,989 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:45:31,989 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:45:31,989 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:45:31,989 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:45:31,989 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:45:31,989 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:45:31,992 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:45:32,657 [INFO] Handling GET request for /get-insights
2025-07-20 22:45:32,722 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:45:32,723 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:45:32,730 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 22:45:35,093 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 22:45:40,732 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:45:42,733 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:45:44,636 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a history of hives following an injection of dexamethasone', skipping
2025-07-20 22:45:50,377 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:45:52,377 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:59:32,341 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:32,344 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:59:32,345 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:59:32,345 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:59:32,345 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:59:32,345 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:59:32,345 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:59:32,345 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:59:32,347 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:59:34,511 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:59:34,511 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:59:34,512 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:59:34,512 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:59:34,512 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:59:34,512 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:59:34,512 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:59:34,513 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:59:34,515 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 22:59:35,034 [INFO] Handling GET request for /get-insights
2025-07-20 22:59:35,111 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 22:59:35,111 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:59:35,121 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:35,622 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:35,623 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:59:35,623 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:59:35,623 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:59:35,624 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:59:35,624 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:59:35,624 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:59:35,624 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 22:59:35,625 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 22:59:36,946 [WARNING] Rate limited by Semantic Scholar for '1. Urticaria:', skipping
2025-07-20 22:59:41,612 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 22:59:41,613 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 22:59:41,614 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 22:59:41,614 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 22:59:41,614 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 22:59:41,614 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 22:59:41,614 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 22:59:41,614 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-20 22:59:41,616 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-20 22:59:41,879 [INFO] Handling GET request for /get-insights
2025-07-20 22:59:41,885 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-20 22:59:41,885 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 22:59:41,892 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-20 22:59:43,040 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:59:44,484 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 22:59:45,041 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:59:46,902 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:59:50,176 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 22:59:52,177 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 22:59:52,529 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 22:59:54,309 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 22:59:54,530 [INFO] Returning 2 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 22:59:58,115 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 23:00:00,115 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-20 23:00:37,349 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:00:37,349 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:00:37,349 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:00:37,349 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:00:37,350 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:00:37,350 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:37,350 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:37,350 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:00:37,350 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:00:37,350 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:00:37,350 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:00:37,350 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:00:37,350 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:00:37,350 [INFO] Fetching history for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-20 23:00:37,353 [INFO] Retrieved 1 transcripts for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-20 23:00:37,621 [INFO] Handling GET request for /get-insights
2025-07-20 23:00:37,626 [INFO] Simplified diagnoses for searching: ['1. Allergic Rhinitis:', '- Patient reports a long history of allergies that have worsened over time']
2025-07-20 23:00:37,628 [INFO] Processing diagnosis: 1. Allergic Rhinitis:
2025-07-20 23:00:37,640 [INFO] Found 0 insights for patient 687086b8e5c143d340b301c3 using GSI
2025-07-20 23:00:39,887 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Allergic Rhinitis:
2025-07-20 23:00:45,524 [INFO] Fetched 1 insights from PubMed for condition: 1. Allergic Rhinitis:
2025-07-20 23:00:47,525 [INFO] Processing diagnosis: - Patient reports a long history of allergies that have worsened over time
2025-07-20 23:00:49,244 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a long history of allergies that have worsened over time', skipping
2025-07-20 23:00:49,374 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:49,375 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:00:49,375 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:00:49,375 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:00:49,375 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:00:49,376 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:00:49,376 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:00:49,377 [INFO] Fetching history for patient 686762fc428346e14e0c556b in tenant ceo@advanceai.ai
2025-07-20 23:00:49,379 [INFO] Retrieved 1 transcripts for patient 686762fc428346e14e0c556b in tenant ceo@advanceai.ai
2025-07-20 23:00:49,646 [INFO] Handling GET request for /get-insights
2025-07-20 23:00:49,650 [INFO] Simplified diagnoses for searching: ['1. Anaphylaxis:', '- Patient has a history of anaphylactic reactions to peanuts']
2025-07-20 23:00:49,650 [INFO] Processing diagnosis: 1. Anaphylaxis:
2025-07-20 23:00:49,656 [INFO] Found 0 insights for patient 686762fc428346e14e0c556b using GSI
2025-07-20 23:00:52,005 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Anaphylaxis:
2025-07-20 23:00:54,857 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-20 23:00:56,279 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:00:56,280 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:00:56,280 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:00:56,280 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:00:56,280 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:00:56,281 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:00:56,281 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:00:56,283 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:00:56,809 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:00:56,858 [INFO] Returning 3 insights for patient 687086b8e5c143d340b301c3
2025-07-20 23:00:57,075 [INFO] Handling GET request for /get-insights
2025-07-20 23:00:57,078 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:00:57,079 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:00:57,673 [INFO] Fetched 1 insights from PubMed for condition: 1. Anaphylaxis:
2025-07-20 23:00:59,382 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:00:59,674 [INFO] Processing diagnosis: - Patient has a history of anaphylactic reactions to peanuts
2025-07-20 23:01:00,916 [WARNING] Rate limited by Semantic Scholar for '- Patient has a history of anaphylactic reactions to peanuts', skipping
2025-07-20 23:01:02,547 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:01:02,548 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:01:02,548 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:01:02,548 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:01:02,549 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:01:02,549 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:01:02,549 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:01:02,549 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-20 23:01:02,551 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-20 23:01:02,826 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-20 23:01:03,069 [INFO] Handling GET request for /get-insights
2025-07-20 23:01:03,072 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-20 23:01:03,073 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:01:04,682 [WARNING] No PubMed articles found for condition: - Patient has a history of anaphylactic reactions to peanuts
2025-07-20 23:01:05,025 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:01:05,576 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:01:06,524 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:01:06,524 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:01:06,525 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:01:06,525 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:01:06,525 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:01:06,525 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:01:06,526 [INFO] Fetching history for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-20 23:01:06,527 [INFO] Retrieved 1 transcripts for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-20 23:01:06,682 [INFO] Returning 2 insights for patient 686762fc428346e14e0c556b
2025-07-20 23:01:06,798 [INFO] Found 0 insights for patient 687086b8e5c143d340b301c3 using GSI
2025-07-20 23:01:06,943 [INFO] Handling GET request for /get-insights
2025-07-20 23:01:06,947 [INFO] Simplified diagnoses for searching: ['1. Allergic Rhinitis:', '- Patient reports a long history of allergies that have worsened over time']
2025-07-20 23:01:06,947 [INFO] Processing diagnosis: 1. Allergic Rhinitis:
2025-07-20 23:01:07,026 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:01:08,911 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:01:09,199 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Allergic Rhinitis:
2025-07-20 23:01:11,202 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:01:13,203 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 23:01:14,644 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:01:14,668 [INFO] Fetched 1 insights from PubMed for condition: 1. Allergic Rhinitis:
2025-07-20 23:01:15,129 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 23:01:16,645 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:01:16,669 [INFO] Processing diagnosis: - Patient reports a long history of allergies that have worsened over time
2025-07-20 23:01:18,621 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-20 23:01:18,934 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-20 23:01:20,935 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-20 23:01:24,212 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-20 23:01:26,212 [INFO] Returning 4 insights for patient 687086b8e5c143d340b301c3
2025-07-20 23:06:11,063 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:11,063 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:11,063 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:11,064 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:11,064 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:11,064 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:11,064 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:11,064 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:11,064 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:06:11,066 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:12,560 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:12,561 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:12,561 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:12,561 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:12,561 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:12,561 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:12,562 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:06:12,564 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:06:13,153 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:06:13,343 [INFO] Handling GET request for /get-insights
2025-07-20 23:06:13,347 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:06:13,348 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:06:13,570 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:13,570 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:13,570 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:13,570 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:13,570 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:13,571 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:13,571 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:13,571 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:13,572 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:13,572 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:13,572 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:13,572 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:13,572 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:13,572 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:06:13,574 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:06:15,094 [WARNING] Rate limited by Semantic Scholar for '1. Urticaria:', skipping
2025-07-20 23:06:21,187 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:06:23,188 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:06:24,542 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:06:30,515 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:06:32,516 [INFO] Returning 2 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:06:47,702 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:47,702 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:47,702 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:47,702 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:47,702 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:47,703 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:47,703 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:47,703 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:47,703 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:47,703 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:47,703 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:47,703 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:47,703 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:47,704 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:06:47,705 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:06:49,616 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:49,616 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:49,616 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:49,616 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:49,616 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:49,617 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:49,617 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:49,617 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:49,617 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:49,617 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:49,618 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:49,618 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:49,618 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:49,618 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:06:49,621 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:06:50,138 [INFO] Handling GET request for /get-insights
2025-07-20 23:06:50,142 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:06:50,144 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:06:50,152 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:06:51,258 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:06:51,259 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:06:51,259 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:06:51,259 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:06:51,260 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:06:51,260 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:06:51,260 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:06:51,260 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:06:51,262 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:06:52,425 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:06:58,048 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:07:00,049 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:07:01,904 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:07:07,657 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:07:09,658 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:10:07,933 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:10:07,933 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:10:07,933 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:10:07,933 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:10:07,933 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:10:07,934 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:07,936 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:07,936 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:10:07,937 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:10:07,937 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:10:07,937 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:10:07,937 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:10:07,937 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:10:07,937 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:10:07,940 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:10:09,093 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:10:09,093 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:10:09,093 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:10:09,093 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:10:09,094 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:10:09,094 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:09,094 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:09,094 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:10:09,094 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:10:09,094 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:10:09,094 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:10:09,094 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:10:09,094 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:10:09,094 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:10:09,097 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:10:09,630 [INFO] Handling GET request for /get-insights
2025-07-20 23:10:09,688 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:10:09,689 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:10:09,690 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:10,452 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:10,453 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:10:10,453 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:10:10,453 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:10:10,453 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:10:10,454 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:10:10,454 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:10:10,454 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:10:10,456 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:10:12,076 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:10:17,712 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:10:19,713 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:10:21,600 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:10:27,319 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:10:29,320 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:10:44,374 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:44,375 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:10:44,375 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:10:44,375 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:10:44,375 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:10:44,376 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:10:44,376 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:10:44,376 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:10:44,378 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:10:46,133 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:10:46,133 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:10:46,133 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:10:46,133 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:10:46,134 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:10:46,134 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:46,134 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:10:46,134 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:10:46,134 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:10:46,134 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:10:46,134 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:10:46,134 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:10:46,134 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:10:46,134 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:10:46,137 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:10:46,716 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:10:47,708 [INFO] Handling GET request for /get-insights
2025-07-20 23:10:47,712 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:10:47,713 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:10:49,983 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:10:55,610 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:10:57,611 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:10:59,381 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:11:05,341 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:11:07,342 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:14:27,152 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:14:27,154 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:14:27,154 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:14:27,154 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:14:27,154 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:14:27,154 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:14:27,154 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-20 23:14:27,156 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-20 23:14:33,268 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:14:33,269 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:14:33,269 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:14:33,269 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:14:33,269 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:14:33,269 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:14:33,270 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:14:33,272 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:14:33,900 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-20 23:14:34,857 [INFO] Handling GET request for /get-insights
2025-07-20 23:14:34,860 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:14:34,860 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:14:37,192 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:14:43,292 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:14:45,293 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:14:47,106 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:14:53,902 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:14:55,903 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-20 23:18:11,689 [INFO] üîç DEBUG: Authorization header present: True
2025-07-20 23:18:11,689 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-20 23:18:11,689 [INFO] üîç DEBUG: Token length: 1189
2025-07-20 23:18:11,689 [INFO] üîç DEBUG: Starting token verification...
2025-07-20 23:18:11,690 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-20 23:18:11,690 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:18:11,690 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-20 23:18:11,690 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-20 23:18:11,690 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-20 23:18:11,690 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-20 23:18:11,691 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-20 23:18:11,691 [INFO] üîç DEBUG: Token verification result: True
2025-07-20 23:18:11,691 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-20 23:18:11,691 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:18:11,693 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-20 23:18:13,279 [INFO] Handling GET request for /get-insights
2025-07-20 23:18:13,327 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-20 23:18:13,327 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-20 23:18:15,695 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-20 23:18:21,327 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-20 23:18:23,327 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:18:25,134 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:18:31,957 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-20 23:18:33,958 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 09:54:15,623 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 09:54:15,623 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 09:54:16,448 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 09:54:16,527 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 09:54:16,527 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 09:54:16,540 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 09:54:16,557 [INFO] MongoDB indexes created successfully
2025-07-21 09:54:16,558 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 11:04:56,275 [INFO] Received data: {'email': 'avikanak.bkr+9@gmail.com', 'stripeToken': 'tok_1RnHWdQolxBWu9VaiNmdg8nu'}
2025-07-21 11:04:56,275 [INFO] Email: avikanak.bkr+9@gmail.com, Stripe Token: tok_1RnHWdQolxBWu9VaiNmdg8nu
2025-07-21 11:05:21,388 [INFO] üìß ACTIVATION EMAIL: Processing for avikanak.bkr+9@gmail.com
2025-07-21 11:05:21,388 [ERROR] ‚ùå Gmail SMTP credentials not configured
2025-07-21 11:05:21,388 [ERROR] ‚ùå Failed to send welcome email to avikanak.bkr+9@gmail.com
2025-07-21 11:06:57,898 [INFO] üìß MANUAL WELCOME EMAIL: Sending to avikanak.bkr+17@gmail.com
2025-07-21 11:06:57,899 [ERROR] ‚ùå Gmail SMTP credentials not configured
2025-07-21 11:06:57,899 [ERROR] ‚ùå Failed to send welcome email to avikanak.bkr+17@gmail.com
2025-07-21 11:08:46,556 [INFO] üìß ACTIVATION EMAIL: Processing for avikanak.bkr+17@gmail.com
2025-07-21 11:08:46,556 [ERROR] ‚ùå Gmail SMTP credentials not configured
2025-07-21 11:08:46,556 [ERROR] ‚ùå Failed to send welcome email to avikanak.bkr+17@gmail.com
2025-07-21 11:13:02,353 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:13:02,353 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:13:02,353 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:13:02,353 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:13:02,390 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:13:02,391 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:13:02,391 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:13:02,394 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:13:02,399 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:13:02,399 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:13:02,399 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:13:02,399 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:13:02,399 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:13:02,399 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:13:02,402 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:13:04,882 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:13:04,883 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:13:04,883 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:13:04,883 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:13:04,884 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:13:04,884 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:13:04,884 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:13:04,884 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:13:04,884 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:13:04,884 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:13:04,884 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:13:04,884 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:13:04,884 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:13:04,885 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:13:04,888 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:16:03,364 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:16:03,364 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:16:03,365 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:16:03,365 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:16:03,365 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:16:03,365 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:16:03,366 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:16:03,366 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:16:03,366 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:16:03,368 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:16:05,883 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:16:05,884 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:16:05,885 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:16:05,885 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:16:05,885 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:16:05,885 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:16:05,885 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:16:05,885 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:16:05,886 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:35:25,372 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 11:35:25,372 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 11:35:25,473 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 11:35:25,610 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 11:35:25,611 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 11:35:25,623 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 11:35:25,640 [INFO] MongoDB indexes created successfully
2025-07-21 11:35:25,641 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 11:36:01,816 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:36:01,816 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:36:01,816 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:36:01,817 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:36:01,866 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:36:01,867 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:36:01,867 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:36:01,868 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:36:01,869 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:36:01,869 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:36:01,869 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:36:01,870 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:36:01,870 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:36:01,870 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:36:01,874 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:36:04,322 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Token length: 1242
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 11:36:04,323 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 11:36:04,324 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 11:36:04,324 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+17@gmail.com
2025-07-21 11:36:04,324 [INFO] ‚úÖ DEBUG: Token sub: e1a3cd3a-c061-70d0-136b-42601be8df7f
2025-07-21 11:36:04,324 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 11:36:04,324 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+17@gmail.com', 'username': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'sub': 'e1a3cd3a-c061-70d0-136b-42601be8df7f', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'isAdmin', 'auth_type': 'cognito'}
2025-07-21 11:36:04,324 [INFO] Fetching patients for tenant_id: avikanak.bkr+17@gmail.com
2025-07-21 11:36:04,326 [INFO] Found 0 patients for tenant avikanak.bkr+17@gmail.com
2025-07-21 11:38:29,249 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 11:38:29,249 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 11:38:29,351 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 11:38:29,414 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 11:38:29,415 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 11:38:29,424 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 11:38:29,438 [INFO] MongoDB indexes created successfully
2025-07-21 11:38:29,440 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 13:50:54,922 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 13:50:54,922 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 13:50:55,023 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 13:50:55,132 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 13:50:55,132 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 13:50:55,143 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 13:50:55,160 [INFO] MongoDB indexes created successfully
2025-07-21 13:50:55,162 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 14:03:16,044 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 14:03:16,044 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 14:03:16,148 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 14:03:16,214 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 14:03:16,215 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 14:03:16,224 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 14:03:16,239 [INFO] MongoDB indexes created successfully
2025-07-21 14:03:16,240 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 14:45:21,251 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 14:45:21,251 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 14:45:21,354 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 14:45:21,421 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 14:45:21,421 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 14:45:21,431 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 14:45:21,448 [INFO] MongoDB indexes created successfully
2025-07-21 14:45:21,449 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 14:45:32,516 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 14:45:32,517 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 14:45:32,620 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 14:45:32,682 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 14:45:32,683 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 14:45:32,692 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 14:45:32,707 [INFO] MongoDB indexes created successfully
2025-07-21 14:45:32,707 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 14:47:57,481 [ERROR] Error processing /api/register request: name 'jsonify' is not defined
2025-07-21 14:57:42,451 [ERROR] Error processing /api/register request: name 'jsonify' is not defined
2025-07-21 15:04:47,128 [INFO] Received data: {'email': 'avikanak.bkr+10@gmail.com', 'stripeToken': 'tok_1RnLGjQolxBWu9Va80rOCDgK'}
2025-07-21 15:04:47,129 [INFO] Email: avikanak.bkr+10@gmail.com, Stripe Token: tok_1RnLGjQolxBWu9Va80rOCDgK
2025-07-21 15:06:04,619 [INFO] üìß ACTIVATION EMAIL: Processing for avikanak.bkr+10@gmail.com
2025-07-21 15:06:04,619 [ERROR] ‚ùå Gmail SMTP credentials not configured
2025-07-21 15:06:04,620 [ERROR] ‚ùå Failed to send welcome email to avikanak.bkr+10@gmail.com
2025-07-21 15:11:47,137 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 15:11:47,137 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 15:11:47,240 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 15:11:47,303 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 15:11:47,303 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 15:11:47,313 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 15:11:47,330 [INFO] MongoDB indexes created successfully
2025-07-21 15:11:47,330 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 15:12:52,832 [INFO] Received data: {'email': 'avikanak.bkr+11@gmail.com', 'stripeToken': 'tok_1RnLOZQolxBWu9VarLnHRBoS'}
2025-07-21 15:12:52,832 [INFO] Email: avikanak.bkr+11@gmail.com, Stripe Token: tok_1RnLOZQolxBWu9VarLnHRBoS
2025-07-21 15:13:47,542 [INFO] üìß ACTIVATION EMAIL: Processing for avikanak.bkr+11@gmail.com
2025-07-21 15:13:47,542 [ERROR] ‚ùå Gmail SMTP credentials not configured
2025-07-21 15:13:47,542 [ERROR] ‚ùå Failed to send welcome email to avikanak.bkr+11@gmail.com
2025-07-21 15:14:10,969 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 15:14:10,969 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 15:14:10,970 [INFO] üîç DEBUG: Token length: 1194
2025-07-21 15:14:10,970 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 15:14:11,067 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 15:14:11,068 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:11,068 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:11,069 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 15:14:11,070 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 15:14:11,070 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+11@gmail.com
2025-07-21 15:14:11,070 [INFO] ‚úÖ DEBUG: Token sub: 01136d8a-e091-7095-6c25-3f8b0de89126
2025-07-21 15:14:11,070 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 15:14:11,071 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+11@gmail.com', 'username': '01136d8a-e091-7095-6c25-3f8b0de89126', 'sub': '01136d8a-e091-7095-6c25-3f8b0de89126', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'family', 'auth_type': 'cognito'}
2025-07-21 15:14:11,071 [INFO] Fetching patients for tenant_id: avikanak.bkr+11@gmail.com
2025-07-21 15:14:11,073 [INFO] Found 0 patients for tenant avikanak.bkr+11@gmail.com
2025-07-21 15:14:13,588 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 15:14:13,588 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 15:14:13,588 [INFO] üîç DEBUG: Token length: 1194
2025-07-21 15:14:13,588 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 15:14:13,588 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 15:14:13,589 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:13,589 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:13,589 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 15:14:13,589 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 15:14:13,590 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+11@gmail.com
2025-07-21 15:14:13,590 [INFO] ‚úÖ DEBUG: Token sub: 01136d8a-e091-7095-6c25-3f8b0de89126
2025-07-21 15:14:13,590 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 15:14:13,590 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+11@gmail.com', 'username': '01136d8a-e091-7095-6c25-3f8b0de89126', 'sub': '01136d8a-e091-7095-6c25-3f8b0de89126', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'family', 'auth_type': 'cognito'}
2025-07-21 15:14:13,590 [INFO] Fetching patients for tenant_id: avikanak.bkr+11@gmail.com
2025-07-21 15:14:13,592 [INFO] Found 0 patients for tenant avikanak.bkr+11@gmail.com
2025-07-21 15:14:16,095 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 15:14:16,095 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 15:14:16,095 [INFO] üîç DEBUG: Token length: 1194
2025-07-21 15:14:16,095 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 15:14:16,095 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 15:14:16,096 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:16,096 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 15:14:16,096 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 15:14:16,096 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 15:14:16,096 [INFO] ‚úÖ DEBUG: Token email: avikanak.bkr+11@gmail.com
2025-07-21 15:14:16,096 [INFO] ‚úÖ DEBUG: Token sub: 01136d8a-e091-7095-6c25-3f8b0de89126
2025-07-21 15:14:16,096 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 15:14:16,096 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'avikanak.bkr+11@gmail.com', 'username': '01136d8a-e091-7095-6c25-3f8b0de89126', 'sub': '01136d8a-e091-7095-6c25-3f8b0de89126', 'first_name': 'Avinash ', 'last_name': 'Singh', 'specialty': 'family', 'auth_type': 'cognito'}
2025-07-21 15:14:16,096 [INFO] Fetching patients for tenant_id: avikanak.bkr+11@gmail.com
2025-07-21 15:14:16,099 [INFO] Found 0 patients for tenant avikanak.bkr+11@gmail.com
2025-07-21 15:14:45,069 [ERROR] Error processing /api/register request: name 'jsonify' is not defined
2025-07-21 15:17:46,706 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 15:17:46,706 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 15:17:46,808 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 15:17:46,872 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 15:17:46,873 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 15:17:46,883 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 15:17:46,899 [INFO] MongoDB indexes created successfully
2025-07-21 15:17:46,901 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 15:18:28,529 [ERROR] Error processing /api/register request: name 'jsonify' is not defined
2025-07-21 15:25:50,726 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 15:25:50,726 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 15:25:50,830 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 15:25:50,898 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 15:25:50,898 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 15:25:50,908 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 15:25:50,927 [INFO] MongoDB indexes created successfully
2025-07-21 15:25:50,929 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 15:45:04,476 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 15:45:04,476 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 15:45:04,577 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 15:45:04,641 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 15:45:04,642 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 15:45:04,651 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 15:45:04,669 [INFO] MongoDB indexes created successfully
2025-07-21 15:45:04,670 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 17:45:45,613 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 17:45:45,614 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 17:45:45,716 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 17:45:45,789 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 17:45:45,789 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 17:45:45,799 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 17:45:45,819 [INFO] MongoDB indexes created successfully
2025-07-21 17:45:45,820 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 17:46:12,926 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 17:46:12,926 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 17:46:13,028 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 17:46:13,095 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 17:46:13,095 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 17:46:13,105 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 17:46:13,121 [INFO] MongoDB indexes created successfully
2025-07-21 17:46:13,122 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 17:46:32,886 [ERROR] Error processing /api/register request: name 'get_stripe_payments' is not defined
2025-07-21 17:47:09,685 [ERROR] Error processing /api/register request: name 'get_stripe_payments' is not defined
2025-07-21 17:52:38,499 [ERROR] Error processing /api/register request: name 'get_stripe_payments' is not defined
2025-07-21 17:52:50,417 [INFO] Logging setup complete. Logs will be written to /var/www/medora-web-backend/flask-app.log and console.
2025-07-21 17:52:50,417 [INFO] Cognito authentication enabled for region: ap-south-1
2025-07-21 17:52:50,517 [INFO] Successfully initialized AWS clients (including SES for enterprise features)
2025-07-21 17:52:50,579 [INFO] Created indexes on tenantId fields and enterprise collections in MongoDB
2025-07-21 17:52:50,579 [INFO] Successfully connected to MongoDB with enterprise collections
2025-07-21 17:52:50,589 [INFO] Successfully loaded private key for IMS FHIR authentication
2025-07-21 17:52:50,604 [INFO] MongoDB indexes created successfully
2025-07-21 17:52:50,605 [WARNING] ‚ö†Ô∏è Schedule library not available, skipping background scheduler
2025-07-21 18:00:32,501 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 18:00:32,503 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 18:00:32,503 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 18:00:32,504 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 18:00:32,539 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 18:00:32,539 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:32,539 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:32,540 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 18:00:32,541 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 18:00:32,541 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 18:00:32,541 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 18:00:32,542 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 18:00:32,542 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 18:00:32,542 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 18:00:32,544 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 18:00:39,766 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:39,767 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 18:00:39,768 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 18:00:39,768 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 18:00:39,768 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 18:00:39,768 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 18:00:39,768 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 18:00:39,768 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 18:00:39,771 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 18:00:40,351 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 18:00:41,301 [INFO] Handling GET request for /get-insights
2025-07-21 18:00:41,306 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 18:00:41,306 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 18:00:44,170 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 18:00:50,526 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 18:00:52,527 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 18:00:52,976 [INFO] Handling POST request for /api/visit/start
2025-07-21 18:00:52,976 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 18:00:52,985 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 18:00:52,987 [INFO] Patient kikokk not found, creating new patient
2025-07-21 18:00:52,991 [INFO] Created new patient with ID: 687e8054882a829c5cf8b31e
2025-07-21 18:00:52,995 [INFO] Visit started: 770f808f-d508-4705-944d-4ad98d813dde for patient 687e8054882a829c5cf8b31e by ceo@advanceai.ai
2025-07-21 18:00:54,506 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 18:00:54,640 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 18:00:54,640 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 18:00:54,640 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 18:00:54,640 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 18:00:54,640 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 18:00:54,641 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:54,641 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:54,641 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 18:00:54,641 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 18:00:54,641 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 18:00:54,641 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 18:00:54,641 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 18:00:54,641 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 18:00:54,641 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 18:00:54,643 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-21 18:00:54,916 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 18:00:54,916 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 18:00:54,916 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 18:00:54,916 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 18:00:54,916 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 18:00:54,917 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:54,917 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:00:54,917 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 18:00:54,917 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 18:00:54,917 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 18:00:54,917 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 18:00:54,917 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 18:00:54,917 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 18:00:54,917 [INFO] Fetching history for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 18:00:54,919 [INFO] Retrieved 0 transcripts for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 18:01:00,199 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 18:01:02,200 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 18:01:35,564 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-21 18:01:35,564 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 18:01:35,569 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 18:01:35,575 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 21), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 21, 18, 1, 35, 575201)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 21), of type: <class 'datetime.date'>
2025-07-21 18:01:35,575 [INFO] üìä Usage updated for ceo@advanceai.ai: 43/1000 (4.3%)
2025-07-21 18:01:36,413 [INFO] Extracted allergy conditions: ['Urticaria', 'Allergic Rhinitis', 'Food Allergy']
2025-07-21 18:01:41,004 [INFO] ‚úÖ FORMATTING: Generated assessment with 3 sections
2025-07-21 18:01:41,004 [INFO] Generated allergy assessment: 1. Urticaria:

- Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday, indicating an acute onset and duration of less than 6 weeks
...
2025-07-21 18:01:46,069 [INFO] Generated allergy treatment plan
2025-07-21 18:01:52,280 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-21 18:01:52,281 [INFO] üìù Full response length: 2866
2025-07-21 18:01:52,281 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-21 18:01:52,281 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-21 18:01:52,281 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-21 18:01:52,281 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-21 18:01:52,282 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-21 18:01:52,282 [INFO] ============================================================
2025-07-21 18:01:52,282 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-21 18:01:52,282 [INFO] üîç HPI LENGTH: 741
2025-07-21 18:01:52,282 [INFO] üîç HPI CONTENT: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,282 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-21 18:01:52,282 [INFO] ============================================================
2025-07-21 18:01:52,283 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 18:01:52,283 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-21 18:01:52,283 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 18:01:52,283 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-21 18:01:52,283 [INFO] üîç HPI LENGTH: 741
2025-07-21 18:01:52,283 [INFO] üîç HPI CONTENT: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,283 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-21 18:01:52,284 [INFO] ============================================================
2025-07-21 18:01:52,284 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,286 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,287 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-21 18:01:52,287 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-21 18:01:52,287 [INFO] üîç HPI LENGTH: 741
2025-07-21 18:01:52,287 [INFO] üîç HPI CONTENT: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,287 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-21 18:01:52,287 [INFO] ============================================================
2025-07-21 18:01:52,287 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-21 18:01:52,287 [INFO] üîç HPI LENGTH: 741
2025-07-21 18:01:52,287 [INFO] üîç HPI CONTENT: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,287 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-21 18:01:52,287 [INFO] ============================================================
2025-07-21 18:01:52,288 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-21 18:01:52,288 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-21 18:01:52,288 [INFO] üîç HPI LENGTH: 741
2025-07-21 18:01:52,288 [INFO] üîç HPI CONTENT: Patient experienced an episode of hives that started on a Friday and persisted until the following Monday. The hives began after the patient ate chicken and chips, which are part of her regular diet, and took a nap. She attempted to manage the symptoms with Benadryl provided by her mother, but the hives did not resolve until after receiving steroids and a Benadryl shot at urgent care over the weekend. The patient then saw Dr. Lam on Monday, after which the hives subsided and did not return. The patient has a history of allergies to eggs and peanut butter during childhood, but these allergies have resolved, and she can now consume these foods without issues. She also has seasonal allergies but currently has no nasal or eye symptoms.
2025-07-21 18:01:52,288 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-21 18:01:52,288 [INFO] ============================================================
2025-07-21 18:01:52,288 [INFO] üîÑ Generating structured recommendations...
2025-07-21 18:01:52,289 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 18:01:52,289 [INFO] ‚úÖ Generated 3 recommendation categories
2025-07-21 18:01:52,289 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 18:01:52,289 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-21 18:01:52,289 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Continue iron supplementation for anemia'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-21 18:01:52,289 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-21 18:01:52,289 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 18:01:52,289 [INFO] ‚úÖ Added 3 structured recommendation categories
2025-07-21 18:01:52,289 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 18:01:52,297 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-21 18:01:52,312 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687e8090882a829c5cf8b320
2025-07-21 18:01:52,579 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 18:01:52,580 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 18:01:52,581 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 18:01:52,582 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 18:01:52,582 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 18:01:52,582 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 18:01:52,582 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 18:01:52,582 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 18:01:52,582 [INFO] Fetching history for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 18:01:52,584 [INFO] Retrieved 1 transcripts for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 18:01:52,873 [INFO] Found 0 insights for patient 687e8054882a829c5cf8b31e using GSI
2025-07-21 18:01:53,867 [INFO] Handling GET request for /get-insights
2025-07-21 18:01:53,872 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday']
2025-07-21 18:01:53,872 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 18:01:56,772 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 18:02:02,407 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 18:02:04,407 [INFO] Processing diagnosis: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday
2025-07-21 18:02:05,408 [INFO] Simplified long condition for Semantic Scholar: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 18:02:06,211 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 18:02:09,212 [INFO] Simplified long condition to: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 18:02:10,113 [WARNING] No PubMed articles found for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 18:02:12,114 [INFO] Returning 2 insights for patient 687e8054882a829c5cf8b31e
2025-07-21 19:40:36,829 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:40:36,829 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:40:36,829 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:40:36,829 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:40:36,829 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:40:36,830 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:36,830 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:36,830 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:40:36,830 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:40:36,830 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:40:36,830 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:40:36,830 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:40:36,830 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:40:36,830 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 19:40:36,832 [INFO] Found 6 patients for tenant ceo@advanceai.ai
2025-07-21 19:40:39,402 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:40:39,402 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:40:39,402 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:40:39,402 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:40:39,402 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:40:39,403 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:39,403 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:39,403 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:40:39,403 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:40:39,404 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:40:39,404 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:40:39,404 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:40:39,404 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:40:39,404 [INFO] Fetching history for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 19:40:39,406 [INFO] Retrieved 1 transcripts for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 19:40:40,007 [INFO] Found 0 insights for patient 687e8054882a829c5cf8b31e using GSI
2025-07-21 19:40:40,956 [INFO] Handling GET request for /get-insights
2025-07-21 19:40:40,961 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday']
2025-07-21 19:40:40,961 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 19:40:43,749 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 19:40:50,115 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:50,776 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:40:50,777 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:40:50,777 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:40:50,777 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:40:50,777 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:40:50,777 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:40:50,777 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:40:50,777 [INFO] Fetching history for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 19:40:50,779 [INFO] Retrieved 1 transcripts for patient 687e8054882a829c5cf8b31e in tenant ceo@advanceai.ai
2025-07-21 19:40:52,115 [INFO] Processing diagnosis: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday
2025-07-21 19:40:53,116 [INFO] Simplified long condition for Semantic Scholar: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:40:53,943 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:40:56,944 [INFO] Simplified long condition to: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:40:57,884 [WARNING] No PubMed articles found for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:40:59,884 [INFO] Returning 2 insights for patient 687e8054882a829c5cf8b31e
2025-07-21 19:41:00,154 [INFO] Handling GET request for /get-insights
2025-07-21 19:41:00,159 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday']
2025-07-21 19:41:00,159 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 19:41:02,451 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 19:41:08,113 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 19:41:10,114 [INFO] Processing diagnosis: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted until the following Monday
2025-07-21 19:41:11,114 [INFO] Simplified long condition for Semantic Scholar: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:41:11,887 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:41:14,887 [INFO] Simplified long condition to: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:41:15,726 [WARNING] No PubMed articles found for condition: - Patient experienced an acute episode of urticaria (hives) that began on a Friday and persisted unt
2025-07-21 19:41:17,727 [INFO] Returning 2 insights for patient 687e8054882a829c5cf8b31e
2025-07-21 19:41:28,839 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:41:28,839 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:41:28,840 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:41:28,840 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:41:28,840 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:41:28,840 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:41:28,841 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:41:28,851 [INFO] Deleted patient 687e8054882a829c5cf8b31e and associated data in tenant ceo@advanceai.ai
2025-07-21 19:43:13,580 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:43:13,581 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:43:13,581 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:43:13,581 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:43:13,581 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:43:13,582 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:43:13,582 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:43:13,582 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:43:13,582 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:43:13,582 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:43:13,582 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:43:13,582 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:43:13,582 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:43:13,582 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 19:43:13,585 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 19:43:13,925 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 19:43:14,871 [INFO] Handling GET request for /get-insights
2025-07-21 19:43:14,875 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 19:43:14,876 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 19:43:17,229 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 19:43:23,081 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 19:43:25,081 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:43:27,007 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:43:30,790 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:43:32,791 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 19:49:12,930 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:49:12,930 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:49:12,930 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:49:12,930 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:49:12,930 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:49:12,931 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:12,931 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:12,931 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:49:12,931 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:49:12,931 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:49:12,931 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:49:12,931 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:49:12,931 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:49:12,931 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 19:49:12,933 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 19:49:15,605 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:49:15,605 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:49:15,606 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:49:15,606 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:49:15,606 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:49:15,606 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:49:15,606 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:49:15,607 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 19:49:15,609 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 19:49:28,780 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:49:28,780 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:49:28,781 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:49:28,781 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:49:28,781 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:49:28,781 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:49:28,782 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:49:28,782 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:49:28,782 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 19:49:28,784 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 19:49:29,117 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 19:49:30,065 [INFO] Handling GET request for /get-insights
2025-07-21 19:49:30,068 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 19:49:30,068 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 19:49:32,484 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 19:49:38,744 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 19:49:40,745 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:49:42,605 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:49:46,427 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 19:49:48,427 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 19:53:59,369 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:53:59,370 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:53:59,370 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:53:59,370 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:53:59,370 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:53:59,371 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:53:59,371 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 19:53:59,373 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 19:54:02,653 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 19:54:02,653 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 19:54:02,653 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 19:54:02,653 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 19:54:02,653 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 19:54:02,654 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:54:02,654 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 19:54:02,654 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 19:54:02,654 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 19:54:02,655 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 19:54:02,655 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 19:54:02,655 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 19:54:02,655 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 19:54:02,655 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 19:54:02,657 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:00:12,100 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:12,101 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:12,102 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:00:12,102 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:00:12,102 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:00:12,102 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:00:12,102 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:00:12,102 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:00:12,102 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:00:12,104 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:00:15,671 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:00:15,671 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:00:15,671 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:00:15,671 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:00:15,672 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:00:15,672 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:15,672 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:15,672 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:00:15,672 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:00:15,672 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:00:15,672 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:00:15,672 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:00:15,672 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:00:15,672 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:00:15,675 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:00:19,196 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:00:19,197 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:00:19,197 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:00:19,197 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:00:19,197 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:00:19,197 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:00:19,198 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:00:19,199 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:00:19,791 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 20:00:20,740 [INFO] Handling GET request for /get-insights
2025-07-21 20:00:20,745 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 20:00:20,745 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:00:23,450 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:00:29,089 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:00:31,089 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:00:32,910 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:00:38,630 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:00:40,631 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 20:10:11,163 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:10:11,163 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:10:11,163 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:10:11,163 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:10:11,163 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:10:11,164 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:11,164 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:11,164 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:10:11,164 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:10:11,164 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:10:11,164 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:10:11,164 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:10:11,164 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:10:11,164 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:10:11,196 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:10:39,128 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:39,129 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:39,129 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:10:39,129 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:10:39,129 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:10:39,129 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:10:39,130 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:10:39,130 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:10:39,130 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:10:39,132 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:43,663 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:10:43,664 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:10:43,664 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:10:43,664 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:10:43,664 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:10:43,664 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:10:43,665 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:10:43,667 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:10:55,781 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:10:55,781 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:10:55,781 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:10:55,781 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:10:55,781 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:10:55,782 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:55,782 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:10:55,782 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:10:55,782 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:10:55,783 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:10:55,783 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:10:55,783 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:10:55,783 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:10:55,783 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:10:55,785 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:10:56,496 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 20:11:04,441 [INFO] Handling GET request for /get-insights
2025-07-21 20:11:04,445 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 20:11:04,445 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:11:07,125 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:11:13,223 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:11:15,223 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:11:16,919 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a history of hives following an injection of dexamethasone', skipping
2025-07-21 20:11:22,617 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:11:24,618 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 20:28:38,312 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:28:38,312 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:28:38,312 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:28:38,312 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:28:38,312 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:28:38,313 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:38,313 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:38,313 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:28:38,313 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:28:38,314 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:28:38,314 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:28:38,314 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:28:38,314 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:28:38,314 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:28:38,316 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:28:41,345 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:28:41,345 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:28:41,345 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:28:41,345 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:28:41,345 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:28:41,346 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:41,346 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:41,346 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:28:41,346 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:28:41,346 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:28:41,346 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:28:41,346 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:28:41,346 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:28:41,346 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:28:41,348 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:28:45,477 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:28:45,478 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:28:45,478 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:28:45,478 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:28:45,478 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:28:45,478 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:28:45,479 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:28:45,481 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:28:46,067 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 20:28:47,020 [INFO] Handling GET request for /get-insights
2025-07-21 20:28:47,024 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 20:28:47,024 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:28:49,714 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:28:55,830 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:28:57,831 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:28:59,651 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:29:05,346 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:29:07,347 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 20:44:00,608 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:00,608 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:00,609 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:00,609 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:00,609 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:00,609 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:00,609 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:00,610 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:44:00,611 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:44:04,127 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:04,127 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:04,127 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:04,127 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:04,127 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:04,128 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:04,128 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:04,128 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:04,128 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:04,128 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:04,129 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:04,129 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:04,129 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:04,129 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:44:04,133 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:44:06,411 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:06,411 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:06,411 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:06,411 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:06,411 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:06,412 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:06,412 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:06,412 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:06,412 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:06,412 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:06,412 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:06,412 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:06,412 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:06,412 [INFO] Fetching history for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:44:06,415 [INFO] Retrieved 1 transcripts for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:44:06,738 [INFO] Found 0 insights for patient 687086b8e5c143d340b301c3 using GSI
2025-07-21 20:44:10,699 [INFO] Handling GET request for /get-insights
2025-07-21 20:44:10,703 [INFO] Simplified diagnoses for searching: ['1. Allergic Rhinitis:', '- Patient reports a long history of allergies that have worsened over time']
2025-07-21 20:44:10,703 [INFO] Processing diagnosis: 1. Allergic Rhinitis:
2025-07-21 20:44:13,229 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Allergic Rhinitis:
2025-07-21 20:44:16,277 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:16,277 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:16,277 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:16,277 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:16,277 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:16,278 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:16,278 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:16,278 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:16,278 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:16,278 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:16,278 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:16,278 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:16,278 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:16,278 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:44:16,280 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 20:44:16,823 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 20:44:19,197 [INFO] Fetched 1 insights from PubMed for condition: 1. Allergic Rhinitis:
2025-07-21 20:44:20,811 [INFO] Handling GET request for /get-insights
2025-07-21 20:44:20,816 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 20:44:20,817 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:44:21,198 [INFO] Processing diagnosis: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:44:23,067 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:44:23,186 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:44:28,688 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:44:28,893 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:44:30,689 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:44:30,894 [INFO] Returning 4 insights for patient 687086b8e5c143d340b301c3
2025-07-21 20:44:32,504 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:44:38,202 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 20:44:40,203 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 20:44:46,639 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:46,639 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:46,640 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:46,640 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:46,640 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:46,640 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:46,641 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:46,641 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:46,641 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:44:46,643 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:44:46,928 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 20:44:50,925 [INFO] Handling GET request for /get-insights
2025-07-21 20:44:50,930 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 20:44:50,930 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:44:53,235 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:44:53,349 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:44:53,349 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:44:53,349 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:44:53,350 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:44:53,350 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:44:53,350 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:53,350 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:44:53,350 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:44:53,350 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:44:53,351 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:44:53,351 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:44:53,351 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:44:53,351 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:44:53,351 [INFO] Fetching history for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:44:53,353 [INFO] Retrieved 1 transcripts for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:44:53,632 [INFO] Found 0 insights for patient 687086b8e5c143d340b301c3 using GSI
2025-07-21 20:44:57,629 [INFO] Handling GET request for /get-insights
2025-07-21 20:44:57,633 [INFO] Simplified diagnoses for searching: ['1. Allergic Rhinitis:', '- Patient reports a long history of allergies that have worsened over time']
2025-07-21 20:44:57,633 [INFO] Processing diagnosis: 1. Allergic Rhinitis:
2025-07-21 20:44:58,883 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:44:59,952 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Allergic Rhinitis:
2025-07-21 20:45:00,884 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:45:01,131 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:01,132 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:45:01,132 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:45:01,132 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:45:01,133 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:45:01,133 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:45:01,133 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:45:01,133 [INFO] Fetching history for patient 686bcd9041fde50b282ab6f3 in tenant ceo@advanceai.ai
2025-07-21 20:45:01,136 [INFO] Retrieved 1 transcripts for patient 686bcd9041fde50b282ab6f3 in tenant ceo@advanceai.ai
2025-07-21 20:45:01,414 [INFO] Found 0 insights for patient 686bcd9041fde50b282ab6f3 using GSI
2025-07-21 20:45:02,769 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:45:05,411 [INFO] Handling GET request for /get-insights
2025-07-21 20:45:05,416 [INFO] Simplified diagnoses for searching: ['1. Gastroesophageal Reflux Disease:', '- Patient was diagnosed with acid reflux one month ago by their primary care physician']
2025-07-21 20:45:05,416 [INFO] Processing diagnosis: 1. Gastroesophageal Reflux Disease:
2025-07-21 20:45:05,637 [INFO] Fetched 1 insights from PubMed for condition: 1. Allergic Rhinitis:
2025-07-21 20:45:06,554 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:45:07,505 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Gastroesophageal Reflux Disease:
2025-07-21 20:45:07,638 [INFO] Processing diagnosis: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:45:08,555 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 20:45:09,597 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:09,630 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:45:09,631 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:45:09,631 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:45:09,631 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:45:09,631 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:45:09,632 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:45:09,632 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:45:09,634 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:11,585 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:45:11,586 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:45:11,586 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:45:11,586 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:45:11,586 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:45:11,586 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:45:11,587 [INFO] Fetching history for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:45:11,590 [INFO] Retrieved 1 transcripts for patient 687086b8e5c143d340b301c3 in tenant ceo@advanceai.ai
2025-07-21 20:45:11,871 [INFO] Found 0 insights for patient 687086b8e5c143d340b301c3 using GSI
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:12,149 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:45:12,150 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:45:12,150 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:45:12,150 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:45:12,150 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:45:12,151 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:45:12,151 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:45:12,151 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:45:12,153 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:45:13,221 [INFO] Fetched 1 insights from PubMed for condition: 1. Gastroesophageal Reflux Disease:
2025-07-21 20:45:15,223 [INFO] Processing diagnosis: - Patient was diagnosed with acid reflux one month ago by their primary care physician
2025-07-21 20:45:15,305 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:45:15,860 [INFO] Handling GET request for /get-insights
2025-07-21 20:45:15,863 [INFO] Simplified diagnoses for searching: ['1. Allergic Rhinitis:', '- Patient reports a long history of allergies that have worsened over time']
2025-07-21 20:45:15,863 [INFO] Processing diagnosis: 1. Allergic Rhinitis:
2025-07-21 20:45:16,903 [WARNING] Rate limited by Semantic Scholar for '- Patient was diagnosed with acid reflux one month ago by their primary care physician', skipping
2025-07-21 20:45:17,106 [WARNING] Rate limited by Semantic Scholar for '1. Allergic Rhinitis:', skipping
2025-07-21 20:45:17,306 [INFO] Returning 4 insights for patient 687086b8e5c143d340b301c3
2025-07-21 20:45:20,702 [WARNING] No PubMed articles found for condition: - Patient was diagnosed with acid reflux one month ago by their primary care physician
2025-07-21 20:45:22,702 [INFO] Returning 2 insights for patient 686bcd9041fde50b282ab6f3
2025-07-21 20:45:22,749 [INFO] Fetched 1 insights from PubMed for condition: 1. Allergic Rhinitis:
2025-07-21 20:45:24,749 [INFO] Processing diagnosis: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:45:26,441 [WARNING] Rate limited by Semantic Scholar for '- Patient reports a long history of allergies that have worsened over time', skipping
2025-07-21 20:45:31,975 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a long history of allergies that have worsened over time
2025-07-21 20:45:33,975 [INFO] Returning 2 insights for patient 687086b8e5c143d340b301c3
2025-07-21 20:53:03,070 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:53:03,070 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:53:03,070 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:53:03,070 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:53:03,071 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:53:03,071 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:03,071 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:03,071 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:53:03,071 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:53:03,071 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:53:03,071 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:53:03,072 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:53:03,072 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:53:03,072 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:53:03,074 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:53:03,750 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:07,182 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:07,183 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:53:07,183 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:53:07,183 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:53:07,183 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:53:07,184 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:53:07,184 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:53:07,184 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:53:07,186 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:09,625 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:53:09,626 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:53:09,626 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:53:09,626 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:53:09,626 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:53:09,626 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:53:09,627 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:53:09,629 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 20:53:09,722 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 20:53:09,723 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 20:53:09,723 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 20:53:09,723 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 20:53:09,723 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 20:53:09,724 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 20:53:09,724 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 20:53:09,726 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 20:53:09,913 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 20:53:13,901 [INFO] Handling GET request for /get-insights
2025-07-21 20:53:13,905 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 20:53:13,905 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 20:53:16,875 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 20:53:25,862 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 20:53:27,862 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:53:29,875 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:53:33,650 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 20:53:35,650 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:35,152 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:35,153 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:02:35,153 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:02:35,153 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:02:35,153 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:02:35,154 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:02:35,154 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:02:35,154 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:02:35,155 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:02:38,728 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:02:38,729 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:02:38,729 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:02:38,729 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:02:38,729 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:02:38,729 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:02:38,730 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:02:38,732 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:02:40,881 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:02:40,882 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:02:40,882 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:02:40,882 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:02:40,882 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:02:40,882 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:02:40,883 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:02:40,885 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:02:41,474 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 21:02:42,413 [INFO] Handling GET request for /get-insights
2025-07-21 21:02:42,417 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 21:02:42,417 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:02:44,744 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:02:50,855 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:02:52,856 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:02:54,637 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:03:00,754 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:03:02,755 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:12,523 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:12,524 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:12,524 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:12,524 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:12,524 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:12,524 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:12,525 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:08:12,527 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:08:15,051 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:15,051 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:15,051 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:15,051 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:15,051 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:15,052 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:15,052 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:15,052 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:15,052 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:15,052 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:15,052 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:15,052 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:15,052 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:15,052 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:08:15,054 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:08:16,609 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:16,610 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:16,610 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:16,610 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:16,610 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:16,611 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:16,611 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:08:16,614 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:08:16,963 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 21:08:17,898 [INFO] Handling GET request for /get-insights
2025-07-21 21:08:17,901 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 21:08:17,902 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:08:20,373 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:08:25,996 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:08:27,997 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:08:30,059 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:08:33,829 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:08:35,830 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 21:08:48,915 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:48,915 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:48,916 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:48,916 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:48,916 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:48,916 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:48,916 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:48,917 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:08:48,919 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:08:50,771 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:50,771 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:50,771 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:50,771 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:50,772 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:50,772 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:50,772 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:50,772 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:50,772 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:50,772 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:50,772 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:50,772 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:50,772 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:50,772 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:08:50,775 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:08:51,321 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 21:08:52,310 [INFO] Handling GET request for /get-insights
2025-07-21 21:08:52,314 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 21:08:52,314 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:08:52,477 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:08:52,478 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:08:52,478 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:08:52,478 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:08:52,478 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:08:52,478 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:08:52,479 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:08:52,481 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:08:55,066 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:09:00,712 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:09:02,713 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:09:04,483 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:09:10,201 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:09:12,202 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 21:11:31,646 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:31,647 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:11:31,648 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:11:31,648 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:11:31,648 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:11:31,648 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:11:31,648 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:11:31,648 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:11:31,650 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:34,170 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:34,171 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:11:34,171 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:11:34,171 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:11:34,171 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:11:34,171 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:11:34,171 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:11:34,171 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:11:34,174 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:35,355 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:11:35,356 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:11:35,356 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:11:35,356 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:11:35,356 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:11:35,357 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:11:35,357 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:11:35,357 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:11:35,359 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:11:35,937 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 21:11:36,892 [INFO] Handling GET request for /get-insights
2025-07-21 21:11:36,895 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 21:11:36,896 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:11:38,646 [WARNING] Rate limited by Semantic Scholar for '1. Urticaria:', skipping
2025-07-21 21:11:45,315 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:11:47,315 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:11:49,114 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:11:54,866 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:11:56,867 [INFO] Returning 2 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:05,262 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:05,263 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:12:05,263 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:12:05,263 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:12:05,264 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:12:05,264 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:12:05,264 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:12:05,264 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:12:05,266 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:07,147 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:12:07,148 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:12:07,148 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:12:07,148 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:12:07,148 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:12:07,148 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:12:07,149 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:12:07,151 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:12:07,443 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 21:12:08,434 [INFO] Handling GET request for /get-insights
2025-07-21 21:12:08,438 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 21:12:08,438 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:12:08,557 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:12:08,557 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:12:08,557 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:12:08,557 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:12:08,558 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:12:08,558 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:08,558 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:12:08,558 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:12:08,558 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:12:08,558 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:12:08,558 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:12:08,559 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:12:08,559 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:12:08,559 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:12:08,561 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:12:10,733 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:12:17,764 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:12:19,765 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:12:21,622 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:12:25,399 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:12:27,400 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 21:17:16,422 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:17:16,422 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:17:16,422 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:17:16,422 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:17:16,422 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:17:16,423 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:16,423 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:16,423 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:17:16,423 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:17:16,423 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:17:16,423 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:17:16,423 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:17:16,423 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:17:16,423 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:17:16,426 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:17:19,991 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:17:19,991 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:17:19,992 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:17:19,992 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:17:19,992 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:17:19,992 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:17:19,992 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:17:19,993 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:17:19,996 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:17:22,459 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:17:22,459 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:17:22,460 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:17:22,461 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:17:22,461 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:17:22,461 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:17:22,461 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:17:22,461 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:17:22,461 [INFO] Fetching history for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:17:22,463 [INFO] Retrieved 1 transcripts for patient 687d36fe0e3e2635265a1646 in tenant ceo@advanceai.ai
2025-07-21 21:17:23,067 [INFO] Found 0 insights for patient 687d36fe0e3e2635265a1646 using GSI
2025-07-21 21:17:26,510 [INFO] Handling GET request for /get-insights
2025-07-21 21:17:26,514 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient reports a history of hives following an injection of dexamethasone']
2025-07-21 21:17:26,515 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:17:28,918 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:17:35,617 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:17:37,618 [INFO] Processing diagnosis: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:17:39,560 [INFO] Fetched 0 insights from Semantic Scholar for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:17:45,714 [INFO] Fetched 1 insights from PubMed for condition: - Patient reports a history of hives following an injection of dexamethasone
2025-07-21 21:17:47,715 [INFO] Returning 3 insights for patient 687d36fe0e3e2635265a1646
2025-07-21 21:18:58,576 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:18:58,576 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:18:58,576 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:18:58,577 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:18:58,577 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:18:58,577 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:18:58,577 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:18:58,577 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:18:58,600 [INFO] Deleted patient 687d36fe0e3e2635265a1646 and associated data in tenant ceo@advanceai.ai
2025-07-21 21:19:05,180 [INFO] Handling POST request for /api/visit/start
2025-07-21 21:19:05,181 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 21:19:05,186 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 21:19:05,187 [INFO] Patient olkolk not found, creating new patient
2025-07-21 21:19:05,190 [INFO] Created new patient with ID: 687eaec9882a829c5cf8b321
2025-07-21 21:19:05,193 [INFO] Visit started: e0c63da7-534a-41f0-8ae5-c9553c3073e0 for patient 687eaec9882a829c5cf8b321 by ceo@advanceai.ai
2025-07-21 21:19:06,594 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:19:06,595 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:19:06,595 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:19:06,595 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:19:06,595 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:19:06,596 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:19:06,596 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:19:06,597 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:19:06,598 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:19:06,870 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:19:06,870 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:19:06,870 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:19:06,870 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:19:06,870 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:19:06,871 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:19:06,872 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:19:06,872 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:19:06,872 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:19:06,872 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:19:06,872 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:19:06,872 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:19:06,872 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:19:06,872 [INFO] Fetching history for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:19:06,874 [INFO] Retrieved 0 transcripts for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:19:43,937 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-21 21:19:43,938 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 21:19:43,943 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 21:19:43,949 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 21), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 21, 21, 19, 43, 949064)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 21), of type: <class 'datetime.date'>
2025-07-21 21:19:43,949 [INFO] üìä Usage updated for ceo@advanceai.ai: 44/1000 (4.4%)
2025-07-21 21:19:44,676 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Food Allergy']
2025-07-21 21:19:48,562 [INFO] ‚úÖ FORMATTING: Generated assessment with 2 sections
2025-07-21 21:19:48,562 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- The patient, a male almost two years old, presents with recurring eczema that has not been officially diagnosed by his pediatrician but is being treated with topical steroids ...
2025-07-21 21:19:55,189 [INFO] Generated allergy treatment plan
2025-07-21 21:20:02,252 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-21 21:20:02,253 [INFO] üìù Full response length: 3023
2025-07-21 21:20:02,253 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] ============================================================
2025-07-21 21:20:02,253 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-21 21:20:02,253 [INFO] üîç HPI LENGTH: 897
2025-07-21 21:20:02,253 [INFO] üîç HPI CONTENT: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,253 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-21 21:20:02,253 [INFO] ============================================================
2025-07-21 21:20:02,253 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 21:20:02,253 [INFO] ‚úÖ Generated 4 recommendation categories
2025-07-21 21:20:02,254 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:20:02,254 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-21 21:20:02,255 [INFO] üîç HPI LENGTH: 897
2025-07-21 21:20:02,255 [INFO] üîç HPI CONTENT: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,255 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-21 21:20:02,255 [INFO] ============================================================
2025-07-21 21:20:02,255 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,256 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,257 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-21 21:20:02,257 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-21 21:20:02,258 [INFO] üîç HPI LENGTH: 897
2025-07-21 21:20:02,258 [INFO] üîç HPI CONTENT: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,258 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-21 21:20:02,258 [INFO] ============================================================
2025-07-21 21:20:02,258 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-21 21:20:02,258 [INFO] üîç HPI LENGTH: 897
2025-07-21 21:20:02,258 [INFO] üîç HPI CONTENT: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,258 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-21 21:20:02,258 [INFO] ============================================================
2025-07-21 21:20:02,259 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-21 21:20:02,259 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-21 21:20:02,259 [INFO] üîç HPI LENGTH: 897
2025-07-21 21:20:02,259 [INFO] üîç HPI CONTENT: Patient, almost 2 years old, has been experiencing recurring eczema for about a year, affecting areas such as ankles, knees, chest, and wrists. The eczema has been treated with topical steroids like triamcinolone, which clears it up temporarily, but it returns. Eucrisa was also tried but did not fully resolve the issue. The patient's older brother had similar issues at the same age, but his cleared up more effectively with topical steroids. A blood food allergen test in February showed sensitivity to sesame, though no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. Eosinophil counts were high at 400, and there was a borderline sensitivity to milk and walnut, though these foods are not avoided. The patient occasionally takes Zyrtec for itching, which helps reduce scratching but does not clear the eczema.
2025-07-21 21:20:02,259 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-21 21:20:02,261 [INFO] ============================================================
2025-07-21 21:20:02,261 [INFO] üîÑ Generating structured recommendations...
2025-07-21 21:20:02,262 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 21:20:02,262 [INFO] ‚úÖ Generated 4 recommendation categories
2025-07-21 21:20:02,262 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:20:02,263 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-21 21:20:02,263 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Continue iron supplementation for anemia'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-21 21:20:02,264 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-21 21:20:02,264 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:20:02,264 [INFO] ‚úÖ Added 4 structured recommendation categories
2025-07-21 21:20:02,265 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:20:02,311 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-21 21:20:02,337 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687eaf02882a829c5cf8b323
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:20:02,606 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:20:02,607 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:20:02,607 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:20:02,607 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:20:02,607 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:20:02,607 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:20:02,607 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:20:02,607 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:20:02,607 [INFO] Fetching history for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:20:02,611 [INFO] Retrieved 1 transcripts for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:20:02,898 [INFO] Found 0 insights for patient 687eaec9882a829c5cf8b321 using GSI
2025-07-21 21:20:06,387 [INFO] Handling GET request for /get-insights
2025-07-21 21:20:06,392 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- The patient']
2025-07-21 21:20:06,392 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-21 21:20:09,439 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-21 21:20:14,921 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-21 21:20:16,922 [INFO] Processing diagnosis: - The patient
2025-07-21 21:20:18,622 [WARNING] Rate limited by Semantic Scholar for '- The patient', skipping
2025-07-21 21:20:24,258 [INFO] Fetched 1 insights from PubMed for condition: - The patient
2025-07-21 21:20:26,258 [INFO] Returning 3 insights for patient 687eaec9882a829c5cf8b321
2025-07-21 21:21:11,209 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:21:11,209 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:21:11,209 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:21:11,209 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:21:11,210 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:21:11,210 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:21:11,211 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:21:11,211 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:21:11,211 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:21:11,211 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:21:11,211 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:21:11,211 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:21:11,211 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:21:11,211 [INFO] Fetching history for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:21:11,221 [INFO] Retrieved 1 transcripts for patient 687c0042ff973097f09d7fa5 in tenant ceo@advanceai.ai
2025-07-21 21:21:11,506 [INFO] Found 0 insights for patient 687c0042ff973097f09d7fa5 using GSI
2025-07-21 21:21:14,997 [INFO] Handling GET request for /get-insights
2025-07-21 21:21:15,002 [INFO] Simplified diagnoses for searching: ['1. Urticaria:', '- Patient experienced a single episode of urticaria lasting approximately 2 weeks']
2025-07-21 21:21:15,002 [INFO] Processing diagnosis: 1. Urticaria:
2025-07-21 21:21:17,562 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Urticaria:
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:21:23,280 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:21:23,281 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:21:23,282 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:21:23,282 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:21:23,282 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:21:23,282 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:21:23,282 [INFO] Fetching history for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:21:23,284 [INFO] Retrieved 1 transcripts for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:21:23,416 [INFO] Fetched 1 insights from PubMed for condition: 1. Urticaria:
2025-07-21 21:21:23,822 [INFO] Found 0 insights for patient 687eaec9882a829c5cf8b321 using GSI
2025-07-21 21:21:25,418 [INFO] Processing diagnosis: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:21:27,297 [INFO] Fetched 1 insights from Semantic Scholar for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:21:27,319 [INFO] Handling GET request for /get-insights
2025-07-21 21:21:27,323 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- The patient']
2025-07-21 21:21:27,324 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-21 21:21:29,853 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-21 21:21:31,076 [WARNING] No PubMed articles found for condition: - Patient experienced a single episode of urticaria lasting approximately 2 weeks
2025-07-21 21:21:33,077 [INFO] Returning 3 insights for patient 687c0042ff973097f09d7fa5
2025-07-21 21:21:35,508 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-21 21:21:37,509 [INFO] Processing diagnosis: - The patient
2025-07-21 21:21:40,026 [INFO] Fetched 1 insights from Semantic Scholar for condition: - The patient
2025-07-21 21:21:45,693 [INFO] Fetched 1 insights from PubMed for condition: - The patient
2025-07-21 21:21:47,693 [INFO] Returning 4 insights for patient 687eaec9882a829c5cf8b321
2025-07-21 21:24:58,842 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:24:58,843 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:24:58,843 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:24:58,844 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:24:58,844 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:24:58,844 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:24:58,844 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:24:58,844 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:24:58,846 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:25:01,347 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:25:01,347 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:25:01,348 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:25:01,348 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:25:01,348 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:25:01,348 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:25:01,349 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:25:01,349 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:25:01,349 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:25:01,351 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:25:04,285 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:25:04,285 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:25:04,285 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:25:04,285 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:25:04,285 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:25:04,286 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:25:04,286 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:25:04,286 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:25:04,286 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:25:04,286 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:25:04,286 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:25:04,286 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:25:04,286 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:25:04,286 [INFO] Fetching history for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:25:04,289 [INFO] Retrieved 1 transcripts for patient 687eaec9882a829c5cf8b321 in tenant ceo@advanceai.ai
2025-07-21 21:25:04,878 [INFO] Found 0 insights for patient 687eaec9882a829c5cf8b321 using GSI
2025-07-21 21:25:08,329 [INFO] Handling GET request for /get-insights
2025-07-21 21:25:08,333 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- The patient']
2025-07-21 21:25:08,333 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-21 21:25:10,687 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-21 21:25:18,256 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-21 21:25:20,257 [INFO] Processing diagnosis: - The patient
2025-07-21 21:25:22,995 [INFO] Fetched 1 insights from Semantic Scholar for condition: - The patient
2025-07-21 21:25:28,696 [INFO] Fetched 1 insights from PubMed for condition: - The patient
2025-07-21 21:25:30,697 [INFO] Returning 4 insights for patient 687eaec9882a829c5cf8b321
2025-07-21 21:26:15,405 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:15,406 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:26:15,406 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:26:15,406 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:26:15,406 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:26:15,407 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:26:15,407 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:26:15,416 [INFO] Deleted patient 687eaec9882a829c5cf8b321 and associated data in tenant ceo@advanceai.ai
2025-07-21 21:26:22,785 [INFO] Handling POST request for /api/visit/start
2025-07-21 21:26:22,786 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 21:26:22,790 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 21:26:22,792 [INFO] Patient pollk not found, creating new patient
2025-07-21 21:26:22,796 [INFO] Created new patient with ID: 687eb07e882a829c5cf8b324
2025-07-21 21:26:22,799 [INFO] Visit started: e22dcb9f-68c7-4a62-819c-8723d74e68a7 for patient 687eb07e882a829c5cf8b324 by ceo@advanceai.ai
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:24,119 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:26:24,120 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:26:24,120 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:26:24,120 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:26:24,120 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:26:24,120 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:26:24,121 [INFO] Fetching patients for tenant_id: ceo@advanceai.ai
2025-07-21 21:26:24,122 [INFO] Found 5 patients for tenant ceo@advanceai.ai
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:26:24,392 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:26:24,393 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:26:24,393 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:26:24,394 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:26:24,394 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:26:24,394 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:26:24,394 [INFO] Fetching history for patient 687eb07e882a829c5cf8b324 in tenant ceo@advanceai.ai
2025-07-21 21:26:24,396 [INFO] Retrieved 0 transcripts for patient 687eb07e882a829c5cf8b324 in tenant ceo@advanceai.ai
2025-07-21 21:26:43,822 [INFO] üîÑ Processing Freed-style transcript analysis
2025-07-21 21:26:43,822 [INFO] üîç DEBUG: Checking subscription for email: ceo@advanceai.ai
2025-07-21 21:26:43,827 [INFO] ‚úÖ ENTERPRISE: Found enterprise trial for ceo@advanceai.ai
2025-07-21 21:26:43,831 [ERROR] ‚ùå Error logging usage analytics: Invalid document {'q': {'email': 'ceo@advanceai.ai', 'date': datetime.date(2025, 7, 21), 'usage_type': 'transcript_analysis'}, 'u': {'$inc': {'count': 1}, '$set': {'updated_at': datetime.datetime(2025, 7, 21, 21, 26, 43, 831355)}}, 'multi': False, 'upsert': True} | cannot encode object: datetime.date(2025, 7, 21), of type: <class 'datetime.date'>
2025-07-21 21:26:43,831 [INFO] üìä Usage updated for ceo@advanceai.ai: 45/1000 (4.5%)
2025-07-21 21:26:44,614 [INFO] Extracted allergy conditions: ['Atopic Dermatitis', 'Food Allergy']
2025-07-21 21:26:48,080 [INFO] ‚úÖ FORMATTING: Generated assessment with 2 sections
2025-07-21 21:26:48,081 [INFO] Generated allergy assessment: 1. Atopic Dermatitis:

- The patient, a male almost two years old, presents with recurring eczema that has been ongoing for about a year. The condition affects the ankles, knees, chest, and wrists, pa...
2025-07-21 21:26:53,986 [INFO] Generated allergy treatment plan
2025-07-21 21:27:01,056 [INFO] üîç AI SOAP ANALYSIS - STEP 4 - AI SOAP GENERATION
2025-07-21 21:27:01,056 [INFO] üìù Full response length: 3256
2025-07-21 21:27:01,056 [INFO] üîç daily_activities: ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] üîç quality_of_life: ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] üîç onset_progression: ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] üîç triggering_factors: ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] üîç associated_complaints: ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] ============================================================
2025-07-21 21:27:01,056 [INFO] üîç STEP 4A - AFTER AI GENERATION - ‚úÖ CLEAN
2025-07-21 21:27:01,056 [INFO] üîç HPI LENGTH: 962
2025-07-21 21:27:01,057 [INFO] üîç HPI CONTENT: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,057 [INFO] üîç STEP 4A - AFTER AI GENERATION - END
2025-07-21 21:27:01,057 [INFO] ============================================================
2025-07-21 21:27:01,057 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 21:27:01,057 [INFO] ‚úÖ Generated 4 recommendation categories
2025-07-21 21:27:01,057 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:27:01,057 [INFO] üîç STEP 5A - AFTER COMBINING - ‚úÖ CLEAN
2025-07-21 21:27:01,057 [INFO] üîç HPI LENGTH: 962
2025-07-21 21:27:01,057 [INFO] üîç HPI CONTENT: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,057 [INFO] üîç STEP 5A - AFTER COMBINING - END
2025-07-21 21:27:01,057 [INFO] ============================================================
2025-07-21 21:27:01,057 [INFO] üîç BEFORE AGGRESSIVE REMOVAL: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,059 [INFO] üîç AFTER AGGRESSIVE REMOVAL: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,060 [INFO] ‚úÖ NO GENERIC CONTENT FOUND
2025-07-21 21:27:01,060 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - ‚úÖ CLEAN
2025-07-21 21:27:01,060 [INFO] üîç HPI LENGTH: 962
2025-07-21 21:27:01,060 [INFO] üîç HPI CONTENT: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,060 [INFO] üîç STEP 5B - AFTER AGGRESSIVE REMOVAL - END
2025-07-21 21:27:01,060 [INFO] ============================================================
2025-07-21 21:27:01,060 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - ‚úÖ CLEAN
2025-07-21 21:27:01,060 [INFO] üîç HPI LENGTH: 962
2025-07-21 21:27:01,060 [INFO] üîç HPI CONTENT: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,060 [INFO] üîç STEP 5C - AFTER FRONTEND COMPATIBILITY - END
2025-07-21 21:27:01,060 [INFO] ============================================================
2025-07-21 21:27:01,060 [INFO] ‚úÖ FINAL VALIDATION PASSED: HPI is completely clean
2025-07-21 21:27:01,061 [INFO] üîç STEP 5D - FINAL RESULT - ‚úÖ CLEAN
2025-07-21 21:27:01,061 [INFO] üîç HPI LENGTH: 962
2025-07-21 21:27:01,061 [INFO] üîç HPI CONTENT: Patient, a 1-year-old male, has been experiencing recurrent eczema for about a year. The eczema affects his ankles, knees, chest, and wrists, particularly in the creasing areas. He recently scratched his knee open in his car seat on the way to the appointment. The condition has been managed with topical steroids like triamcinolone, which clears it up temporarily, but the eczema returns. Eucrisa was also tried, which provided some relief but did not fully resolve the issue. His older brother had a similar issue at the same age, though less severe and resolved with topical steroids. A blood food allergen test in February showed sensitivity to sesame, but no significant changes were observed after avoiding sesame. The patient has been exposed to sesame oil without significant flare-ups. No other food allergies were identified, and no foods are currently being avoided. The patient also experiences nasal symptoms only with feces, but no asthma or hives.
2025-07-21 21:27:01,061 [INFO] üîç STEP 5D - FINAL RESULT - END
2025-07-21 21:27:01,061 [INFO] ============================================================
2025-07-21 21:27:01,061 [INFO] üîÑ Generating structured recommendations...
2025-07-21 21:27:01,061 [INFO] üîß FORCE CREATING structured recommendations
2025-07-21 21:27:01,062 [INFO] ‚úÖ Generated 4 recommendation categories
2025-07-21 21:27:01,062 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:27:01,062 [INFO] üêõ BACKEND DEBUG: structured_recommendations type: <class 'dict'>
2025-07-21 21:27:01,062 [INFO] üêõ BACKEND DEBUG: structured_recommendations content: {'MEDICATION MANAGEMENT': ['Continue iron supplementation for anemia'], 'LIFESTYLE MODIFICATIONS': ['Use free and clear detergent products', 'Moisturize twice daily with fragrance-free products like Vanicream or Vaseline', 'Apply sunscreen when going outdoors'], 'EMERGENCY ACTION PLAN': ['Contact clinic if symptoms worsen before follow-up appointment'], 'PATIENT EDUCATION RESOURCES': ['Educate patient on signs and symptoms of drug allergies', 'Discuss importance of medication adherence and monitoring', 'Provide instructions on proper skin care routine']}
2025-07-21 21:27:01,063 [INFO] üêõ BACKEND DEBUG: Is it a dict? True
2025-07-21 21:27:01,063 [INFO] üêõ BACKEND DEBUG: Keys: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:27:01,063 [INFO] ‚úÖ Added 4 structured recommendation categories
2025-07-21 21:27:01,063 [INFO] ‚úÖ Categories: ['MEDICATION MANAGEMENT', 'LIFESTYLE MODIFICATIONS', 'EMERGENCY ACTION PLAN', 'PATIENT EDUCATION RESOURCES']
2025-07-21 21:27:01,113 [INFO] ‚úÖ Successfully stored Freed-style SOAP notes with structured recommendations
2025-07-21 21:27:01,129 [INFO] ‚úÖ Stored Freed-style transcript with concise AI Insights: 687eb0a5882a829c5cf8b326
2025-07-21 21:27:01,395 [INFO] üîç DEBUG: Authorization header present: True
2025-07-21 21:27:01,395 [INFO] üîç DEBUG: Extracted token (first 20 chars): eyJraWQiOiJkYW5CN2Vr...
2025-07-21 21:27:01,395 [INFO] üîç DEBUG: Token length: 1189
2025-07-21 21:27:01,395 [INFO] üîç DEBUG: Starting token verification...
2025-07-21 21:27:01,395 [INFO] üîç DEBUG: Got Cognito public keys, count: 2
2025-07-21 21:27:01,396 [INFO] üîç DEBUG: Token key ID: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:27:01,396 [INFO] üîç DEBUG: Found matching key for kid: danB7ekHFluvago4lGcpHNTbu2K9yCKM5zCNBb3zpas=
2025-07-21 21:27:01,396 [INFO] üîç DEBUG: Successfully converted JWK to PEM
2025-07-21 21:27:01,396 [INFO] ‚úÖ DEBUG: Token successfully verified
2025-07-21 21:27:01,397 [INFO] ‚úÖ DEBUG: Token email: ceo@advanceai.ai
2025-07-21 21:27:01,397 [INFO] ‚úÖ DEBUG: Token sub: 71133d9a-a0b1-7087-db60-51e329062e91
2025-07-21 21:27:01,397 [INFO] üîç DEBUG: Token verification result: True
2025-07-21 21:27:01,397 [INFO] ‚úÖ DEBUG: Successfully extracted user info: {'email': 'ceo@advanceai.ai', 'username': '71133d9a-a0b1-7087-db60-51e329062e91', 'sub': '71133d9a-a0b1-7087-db60-51e329062e91', 'first_name': 'PANKAJ', 'last_name': 'SABHARWAL', 'specialty': 'allergist', 'auth_type': 'cognito'}
2025-07-21 21:27:01,397 [INFO] Fetching history for patient 687eb07e882a829c5cf8b324 in tenant ceo@advanceai.ai
2025-07-21 21:27:01,399 [INFO] Retrieved 1 transcripts for patient 687eb07e882a829c5cf8b324 in tenant ceo@advanceai.ai
2025-07-21 21:27:01,677 [INFO] Found 0 insights for patient 687eb07e882a829c5cf8b324 using GSI
2025-07-21 21:27:05,168 [INFO] Handling GET request for /get-insights
2025-07-21 21:27:05,172 [INFO] Simplified diagnoses for searching: ['1. Atopic Dermatitis:', '- The patient']
2025-07-21 21:27:05,172 [INFO] Processing diagnosis: 1. Atopic Dermatitis:
2025-07-21 21:27:08,004 [INFO] Fetched 1 insights from Semantic Scholar for condition: 1. Atopic Dermatitis:
2025-07-21 21:27:13,638 [INFO] Fetched 1 insights from PubMed for condition: 1. Atopic Dermatitis:
2025-07-21 21:27:15,639 [INFO] Processing diagnosis: - The patient
2025-07-21 21:27:17,711 [INFO] Fetched 1 insights from Semantic Scholar for condition: - The patient
2025-07-21 21:27:23,354 [INFO] Fetched 1 insights from PubMed for condition: - The patient
2025-07-21 21:27:25,355 [INFO] Returning 4 insights for patient 687eb07e882a829c5cf8b324
